{"version":3,"sources":["App.js","Classes/Constants.js","Classes/TimerClass.js","Components/Toasts.js","Components/Modals.js","Classes/API.js","Components/Tooltip.js","Icons/Chevron.svg","Components/ContextMenuHandler.js","Classes/QueryManager.js","Components/LinkWrapper.js","Components/Posts/Posts.js","Components/InlineLoading.js","Classes/Hooks.js","Classes/Database.js","Help/API Key/0.png","Help/API Key/1.png","Help/API Key/2.png","Pages/SettingsPage.js","Components/General/Header.js","Components/General/SearchField.js","Components/ErrorBoundary.js","Components/Modals/TutorialModal.js","Pages/SetsPage.js","Pages/PostsPage.js","Pages/Home.js","Components/Posts/TagItem.js","Components/TabsList.js","Components/Modals/AuthModal.js","Pages/PopularPostsPage.js","Icons/Kermit.svg","Components/Posts/PostComments.js","Pages/PostPage.js","Assets/TwemojiHeart.svg","Components/PageElements/PageFooter.js","Assets/icon50x50.png","Components/SwitchItem.js","Components/Modals/CreateSetModal.js","Components/Posts/Post.js","serviceWorker.js","index.js"],"names":["window","history","scrollRestoration","lastSearch","QueryManager","get","lastHash","location","hash","lastModalState","lastHistoryPop","Date","now","PageElement","React","useReducer","x","forceUpdate","split","args","App","userReady","user","indexOf","Modals","instance","state","stack","length","push","searchPlaceholder","id","search","userData","subscriptions","map","tag","join","emptyPlaceholder","e621User","name","isMobile","useMediaQuery","query","useState","isScrolledDown","setScrolledDown","useEffect","onAuthStateChanged","Database","auth","uid","then","data","a","username","API","request","_","extend","settings","commit","sets","merge","Settings","props","SettingsRenderer","SettingsPage","localStorage","getItem","setItem","useEventListener","debounce","scrollTop","document","documentElement","innerHeight","className","joinClassNames","onClick","scrollTo","behavior","Handler","addEventListener","getElementById","Posts","setPosts","SetsList","instances","forEach","setSets","value","parseInt","set","pushHistory","modalState","pop","setFetchingState","setImmediate","final","i","arguments","Array","isArray","trim","download","uri","fetch","encodeURIComponent","res","blob","Object","assign","createElement","style","display","href","URL","createObjectURL","body","appendChild","click","revokeObjectURL","remove","catch","err","console","error","Toasts","showToast","getRandomKey","Math","random","toString","substr","formatBytes","bytes","decimals","k","dm","sizes","floor","log","pow","toFixed","toLocaleString","Timer","callback","duration","playAutomatically","this","remainingTime","resume","startTime","clearTimeout","setTimeout","Toast","children","type","life","color","fixedTime","handleRemove","setClosing","closing","timer","useMemo","progressBar","useRef","handleMouseEnter","pause","current","animationPlayState","handleMouseLeave","handleFocus","handleBlur","hasFocus","removeEventListener","onMouseEnter","onMouseLeave","e","end","cursor","backgroundColor","ref","animationDuration","toasts","horizontalStyle","verticalStyle","setState","additionalOptions","toast","key","filter","t","Component","createRef","openModal","modal","closeModal","bind","copyToClipboard","text","navigator","clipboard","writeText","openStringModal","title","description","ImageComponent","image","setLoaded","setFailed","loaded","_setLoaded","events","onLoad","onError","useOnUnmount","test","full","src","controls","loop","muted","preview","alt","ImageModal","url","getSources","buttons","sources","u","container","findIndex","f","index","_setIndex","back","setProperty","nav","dir","querySelector","scrollIntoView","setIndex","expanded","setExpandedState","dependencies","mobileEvents","onTouchStart","tapX","touches","clientX","translation","clientY","handler","abs","innerWidth","parseFloat","getPropertyValue","target","currentTarget","openImageModal","options","async","Promise","resolve","StringModal","response","prevProps","prevState","snapshot","overflowY","marginRight","onBackdropClick","onMouseDown","handleBackdropClick","zIndex","r","m","yesText","noText","yesColor","noColor","onChange","rich","no","setNoState","yes","setYesState","dangerouslySetInnerHTML","__html","defaultValue","endpoint","lastMadeRequest","login","api_key","apiKey","sub","json","loginData","params","URLSearchParams","_client","restOptions","getEndpoint","postId","score","no_unvote","method","post_id","Tooltip","direction","visible","parentElement","classList","add","toLowerCase","ContextMenu","docClickEv","contains","getElementsByClassName","close","activeWrapper","menu","open","ErrorBoundary","Wrapper","handleContextMenu","preventDefault","top","overrideY","left","overrideX","ReactDOM","createPortal","publicProps","position","object","output","exclusions","exclude","rect","getBoundingClientRect","transform","y","height","wrapperClassName","openOnClick","onContextMenu","Item","handleClick","stopPropagation","autoClose","icon","SubMenuItem","width","right","label","ChevronIcon","mount","ToggleItem","checked","Divider","entries","obj","fromEntries","def","delete","replace","dispatchEvent","Event","lastPageChange","hasReachedEnd","additionalTags","posts","isFetching","setSearchQuery","setHash","cachedRequest","setCachedRequest","page","tags","blacklist","_request","isEqual","lastSuccessfulRequest","_posts","post","p","scrollHeight","InlineLoading","useInterval","delay","callInstantly","deps","interval","setInterval","clearInterval","eventType","init","config","authDomain","projectId","storageBucket","messagingSenderId","appId","app","initializeApp","getAuth","db","getFirestore","path","doc","getDoc","exists","_ref","_snapshot","_new","setDoc","serializeObject","updateDoc","ApiKeyTutorialModal","TutorialModal","marginTop","ApiKeyHelp0","ApiKeyHelp1","ApiKeyHelp2","ApiKeySection","saveUsername","update","saveApiKey","placeholder","onBlur","updateDeBouncer","saveDeBouncer","save","Header","hasSearch","signOut","reload","categoryName","formatCamelCase","setting","SettingField","resetValue","defaults","accentColors","primary","secondary","backgroundColors","tertiary","backgroundImage","brightness","min","max","step","blur","positionX","positionY","camelCase","charAt","toUpperCase","slice","setValueState","pickerRef","inputRef","newVal","resetButton","alignItems","onInput","borderColor","maxLength","tooltipMode","TagTypes","tooltip","SearchField","focused","setFocused","autoCompleteEntries","setAutoCompleteEntries","pushState","handleSearch","onFocus","onKeyDown","handleAutoCompleteEntryClick","match","selectionStart","selectionEnd","focus","autoCorrect","autoComplete","padding","categoryIcon","category","antecedent_name","opacity","post_count","errorInfo","moreInfo","message","componentStack","msg","showErrorInfo","renderError","instanceIndex","newSets","_sets","s","splice","shortname","SetsPage","tabs","PostsPage","NavigationButtons","hot","popular","favorites","upvoted","newsPosts","date","NavigationButtonsComponent","Home","news","userAgent","TagItem","TagItemContextMenu","appendToSearch","subscribe","unsubscribe","tagInfo","Fragment","active","Children","toArray","child","AuthModal","signUpMode","setSignUpMode","busy","setBusy","handleSignUp","getElementsByTagName","emailField","passwordField","createUserWithEmailAndPassword","handleLogIn","signInWithEmailAndPassword","code","marginLeft","formatDate","getUTCDate","getMonth","getFullYear","PopularPostsPage","wtf","getUTCMonth","padStart","getDay","setDate","valueAsDate","scale","_defs","_g","_excluded","_extends","source","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgKermit","svgRef","titleId","xmlns","xmlnsXlink","isolation","viewBox","clipPath","fill","fillOpacity","d","ForwardRef","PostComments","comments","setComments","DOMParser","parseFromString","html","comment","dataset","commentId","userId","creatorId","creator","isDeleted","innerHTML","avatarPost","timestamp","dateTime","LinkWrapper","rating","cropped_url","preview_url","PostPage","setPostData","setFailedState","toggleFavorite","is_favorited","removeFavorite","favorite","vote","file","outerHTML","our_score","up","down","fav_count","TabsList","tc","reverse","md5","created_at","size","PageFooter","contacts","website","github","twitter","email","discord","Heart","margin","SwitchItem","defaultChecked","CreateSetModal","field","is_public","errors","textAlign","post_ids","Post","sample","flags","previewImage","tooltipText","setTooltipText","tooltipSide","setTooltipSide","busyButtons","setBusyButtons","previewLoaded","setPreviewLoaded","Button","downloading","clear","b","openInNewTab","conditionalDnp","artist","ext","PostContextMenu","PostModalButtons","toggleSet","postIndex","justifyContent","Boolean","hostname","render","StrictMode","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.d93be9c8.chunk.js","sourcesContent":["import React from \"react\";\nimport { useMediaQuery } from \"react-responsive\";\nimport \"./App.scss\";\nimport \"./city-fog-theme.css\";\nimport { Modals } from \"./Components/Modals\";\nimport HomePage from \"./Pages/Home\";\nimport Toasts from \"./Components/Toasts\";\nimport { joinClassNames } from \"./Classes/Constants\";\nimport ContextMenu from \"./Components/ContextMenuHandler\";\nimport PostsPage from \"./Pages/PostsPage\";\nimport Posts from \"./Components/Posts/Posts\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport Database from \"./Classes/Database\";\nimport AuthModal from \"./Components/Modals/AuthModal\";\nimport SettingsPage, { Settings, SettingsRenderer } from \"./Pages/SettingsPage\";\nimport QueryManager from \"./Classes/QueryManager\";\nimport PostPage from \"./Pages/PostPage\";\nimport API from \"./Classes/API\";\nimport _ from \"lodash\";\nimport SetsList, { SetsPage } from \"./Pages/SetsPage\";\nimport PopularPostsPage from \"./Pages/PopularPostsPage\";\nimport PageFooter from \"./Components/PageElements/PageFooter\";\nimport { useEventListener } from \"./Classes/Hooks\";\nimport { ChevronsUp } from \"react-feather\";\nimport Tooltip from \"./Components/Tooltip\";\n\n/* TODO \n\n\tPut all to-do on README.md\n\tAdd a list for blacklist and subscriptions.\n\tAdd a quick blacklist toggle menu.\n\n */\n\nwindow.history.scrollRestoration = \"manual\";\n\n// Ugh.\nlet lastSearch = QueryManager.get(\"search\") ?? \"\";\nlet lastHash = window.location.hash;\nlet lastModalState = QueryManager.get(\"modalState\");\nexport let lastHistoryPop = Date.now();\nwindow.addEventListener(\"popstate\", () => {\n\tPageElement?.forceUpdate();\n\t\n\t// Get the current search state.\n\tconst search = QueryManager.get(\"search\") ?? \"\";\n\t// If the search states do not match, handle page update.\n\tif ((lastSearch !== search || lastHash !== window.location.hash) && document.getElementById(\"searchField\")) {\n\t\t// Clear all post states.\n\t\tPosts.instance?.setPosts([]);\n\t\tSetsList.instances?.forEach(instance => instance.setSets([ ]));\n\t\t// Set the search field value to the search.\n\t\tdocument.getElementById(\"searchField\").value = search;\n\t\t\n\t\tif (parseInt(QueryManager.get(\"page\")) > 1) {\n\t\t\tQueryManager.set(\"page\", 1, {\n\t\t\t\tpushHistory: false\n\t\t\t});\n\t\t}\n\n\t\t// Set the last search state to the current search state.\n\t\tlastSearch = search;\n\t\t// Set the last hash state to the current hash state.\n\t\tlastHash = window.location.hash;\n\t}\n\t\n\t// Get the current modal state.\n\tconst modalState = QueryManager.get(\"modalState\");\n\t// If the modal states do not match, handle the modal state update.\n\tif (lastModalState !== modalState) {\n\t\t// If the modal state is closed, close the modal.\n\t\t!modalState && Modals.pop();\n\t\t\n\t\t// Set the last modal state to the current modal state.\n\t\tlastModalState = modalState;\n\t}\n\t// Otherwise, handle updating the page.\n\telse {\n\t\t// Gonna be honest, I don't remember what the fuck this does.\n\t\tif (modalState && lastModalState && Modals.instance.state.stack.length)\n\t\t\tQueryManager.set(\"modalState\", null);\n\t\t\n\t\t// Set the fetching states of the posts and sets.\n\t\tPosts.instance?.setFetchingState(true);\n\t\tSetsList.instances?.forEach(instance => instance.setFetchingState(true));\n\n\t\t// Force update the app.\n\t\tApp.forceUpdate?.();\n\t}\n\t\n\t// Set the last pop state time to now.\n\tlastHistoryPop = Date.now();\n\t\n\t// Jesus fucking christ.\n\tsetImmediate(() => {\n\t\tPosts.lastHash = window.location.hash;\n\t});\n});\n\nfunction PageElement() {\n\tconst [, forceUpdate] = React.useReducer(x => x + 1, 0);\n\tPageElement.forceUpdate = forceUpdate;\n\t\n\t// Store the formatted hash in a variable.\n\tconst [hash, ...args] = (window.location.hash\n\t\t.split(/#\\/?/)[1] ?? \"\")\n\t\t.split(\"?\")[0]\n\t\t.split(\"/\");\n\t\n\t// If the user is ready but not logged in, open the auth modal.\n\tif (App.userReady && !App.user && ~[\"subscriptions\", \"favorites\", \"settings\"].indexOf(hash)) {\n\t\t// Make sure the modal is not already open.\n\t\tif (Modals.instance?.state?.stack?.length === 0) {\n\t\t\tModals.push(<AuthModal/>);\n\t\t}\n\t}\n\t\n\t// Set the app hash value.\n\tApp.hash = hash;\n\t\n\t// Zhu Li, do the thing!\n\tswitch (hash) {\n\t\tdefault: return <HomePage/>;\n\t\tcase \"posts\":\n\t\t\treturn <PostsPage searchPlaceholder=\"Search posts...\"/>;\n\t\tcase \"post\":\n\t\t\treturn <PostPage id={args[0]}/>;\n\t\tcase \"hot\":\n\t\t\treturn <PostsPage search=\"order:rank\" searchPlaceholder=\"Search hot posts...\"/>;\n\t\tcase \"popular\":\n\t\t\treturn <PopularPostsPage/>;\n\t\tcase \"sets\":\n\t\t\treturn <SetsPage/>;\n\t\tcase \"subscriptions\":\n\t\t\treturn <PostsPage search={\n\t\t\t\t\t\t\t\t(App.userData?.subscriptions?.length\n\t\t\t\t\t\t\t\t\t? App.userData.subscriptions.map(tag => `~${tag}`)\n\t\t\t\t\t\t\t\t\t: [\"____\"]).join(\" \")}\n\t\t\t\t\t\t\t  searchPlaceholder=\"Search subscriptions...\"\n\t\t\t\t\t\t\t  emptyPlaceholder={(\n\t\t\t\t\t\t\t  \t<>\n\t\t\t\t\t\t\t\t\t<h2>No subscribed posts found.</h2>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\tYou can subscribe to tags by right clicking on them and pressing \"Subscribe.\"\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t  )}/>;\n\t\tcase \"favorites\":\n\t\t\treturn <PostsPage search={`favoritedby:${App.e621User?.name}`}\n\t\t\t\t\t\t\t  searchPlaceholder=\"Search favorites...\"\n\t\t\t\t\t\t\t  emptyPlaceholder={(\n\t\t\t\t\t\t\t  \t<>\n\t\t\t\t\t\t\t\t\t<h2>No favorited posts found.</h2>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\tCheck your search tags, as they also apply to favorites.\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t  )}/>;\n\t\tcase \"upvoted\":\n\t\t\treturn <PostsPage search={`votedup:${App.e621User?.name}`}\n\t\t\t\t\t\t\t  searchPlaceholder=\"Search upvoted posts...\"\n\t\t\t\t\t\t\t  emptyPlaceholder={(\n\t\t\t\t\t\t\t\t  <>\n\t\t\t\t\t\t\t\t\t  <h2>No upvoted posts found.</h2>\n\n\t\t\t\t\t\t\t\t\t  <div>\n\t\t\t\t\t\t\t\t\t\t  Check your search tags, as they also apply to upvotes.\n\t\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t\t  </>\n\t\t\t\t\t\t\t  )}/>;\n\t\tcase \"settings\":\n\t\t\treturn <SettingsPage/>;\n\t}\n}\n\nexport default function App() {\n\tconst isMobile = useMediaQuery({ query: \"(max-width: 1224px)\" });\n\tconst [, forceUpdate] = React.useReducer(x => x + 1, 0);\n\tApp.forceUpdate = forceUpdate;\n\tApp.userData = App.userData ?? { };\n\n\tconst [isScrolledDown, setScrolledDown] = React.useState(false);\n\t\n\tReact.useEffect(() => {\n\t\tonAuthStateChanged(Database.auth, user => {\n\t\t\tif (user) {\n\t\t\t\t// Assign the user.\n\t\t\t\tApp.user = user;\n\t\t\t\t\n\t\t\t\tDatabase.get(\"users\", user.uid).then(async data => {\n\t\t\t\t\t// If the user's username is defined, get their e621 user data.\n\t\t\t\t\tif (data.username)\n\t\t\t\t\t\tApp.e621User = await API.request(`users/${data.username}`);\n\t\t\t\t\t\n\t\t\t\t\t// Assign Firebase data.\n\t\t\t\t\tApp.userData = _.extend({\n\t\t\t\t\t\tsubscriptions: [],\n\t\t\t\t\t\tsettings: { }\n\t\t\t\t\t}, data);\n\t\t\t\t\t\n\t\t\t\t\t// Assign e621 database data.\n\t\t\t\t\t_.extend(App.userData, {\n\t\t\t\t\t\tsets: data.username ? await API.request(\n\t\t\t\t\t\t\t\"post_sets\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcommit: \"Search\",\n\t\t\t\t\t\t\t\t\"search[creator_name]\": data.username\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t) : []\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t// Set user ready state and force update.\n\t\t\t\t\tApp.userReady = true;\n\t\t\t\t\tApp.forceUpdate();\n\t\t\t\t\t\n\t\t\t\t\t// Apply settings\n\t\t\t\t\t_.merge(Settings.props, App.userData.settings);\n\t\t\t\t\tSettingsRenderer.forceUpdate();\n\t\t\t\t\tSettingsPage.forceUpdate?.();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tApp.userReady = true;\n\t\t\t\t\n\t\t\t\tif (!localStorage.getItem(\"hasPromptedLogin\")) {\n\t\t\t\t\tModals.push(<AuthModal/>);\n\t\t\t\t\t\n\t\t\t\t\tlocalStorage.setItem(\"hasPromptedLogin\", \"1\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}, []);\n\n\tuseEventListener(\n\t\t\"scroll\",\n\t\t_.debounce(() => {\n\t\t\tconst { scrollTop } = document.documentElement;\n\n\t\t\tsetScrolledDown(\n\t\t\t\tscrollTop > window.innerHeight && !!~[\n\t\t\t\t\t\"posts\",\n\t\t\t\t\t\"hot\",\n\t\t\t\t\t\"popular\",\n\t\t\t\t\t\"sets\",\n\t\t\t\t\t\"subscriptions\",\n\t\t\t\t\t\"favorites\",\n\t\t\t\t\t\"upvoted\"\n\t\t\t\t].indexOf(App.hash)\n\t\t\t);\n\t\t}, 100)\n\t);\n\n\treturn (\n\t\t<div className={joinClassNames(\"App\", isMobile ? \"Mobile\" : \"Desktop\")}>\n\t\t\t<div className=\"AppBackground\"/>\n\t\t\t\n\t\t\t<div className=\"Main\">\n\t\t\t\t<PageElement/>\n\t\t\t\t\n\t\t\t\t<div\n\t\t\t\t\tclassName={joinClassNames(\"ScrollIndicator\", \"HasTooltip\", \"FlexCenter\", [isScrolledDown, \"Active\"])}\n\t\t\t\t\tonClick={() => (window.scrollTo(0, 0, { behavior: \"smooth\" }, setScrolledDown(false)))}\n\t\t\t\t>\n\t\t\t\t\t<ChevronsUp/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<PageFooter/>\n\n\t\t\t<Modals/>\n\t\t\t<Toasts/>\n\t\t\t<ContextMenu.Handler/>\n\t\t\t\n\t\t\t<SettingsRenderer/>\n\t\t</div>\n\t);\n}","import Toasts from \"../Components/Toasts\";\r\n\r\nexport function joinClassNames() {\r\n    let final = \"\";\r\n\r\n    for (let i = 0; i < arguments.length; i++) {\r\n        switch (typeof(arguments[i])) {\r\n            case (Array.isArray(arguments[i]) && typeof(arguments[i][0]) === \"boolean\" && \"object\"):\r\n                if (arguments[i][0] === true)\r\n                    final += arguments[i][1];\r\n                else if (arguments[i][2])\r\n                    final += arguments[i][2];\r\n                break;\r\n\r\n            default:\r\n                final += arguments[i];\r\n                break;\r\n        }\r\n\r\n        final += \" \";\r\n    }\r\n\r\n    return final.trim();\r\n}\r\n\r\nexport function download(uri) {\r\n    return fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(uri)}`)\r\n        .then(res => res.blob())\r\n        .then(blob => {\r\n            const a = Object.assign(document.createElement(\"a\"), {\r\n                style: { display: \"none\" },\r\n                href: URL.createObjectURL(blob),\r\n                download: uri.split(\"/\")[uri.split(\"/\").length - 1]\r\n            });\r\n\r\n            document.body.appendChild(a);\r\n            a.click();\r\n\r\n            window.URL.revokeObjectURL(a.href);\r\n            a.remove();\r\n        })\r\n        .catch(err => (console.error(err), Toasts.showToast(\"Failed to save image!\", \"Failure\")));\r\n}\r\n\r\nexport function getRandomKey() { return Math.random().toString(36).substr(7); }\r\n\r\n/**\r\n * Converts a number of bytes into a user-readable string.\r\n * Totally not stolen from stackoverflow and tweaked because I've written this exact function 50 times and still can't remember how to do it because fuck math.\r\n * @param bytes\r\n * @param decimals\r\n * @returns {string}\r\n */\r\nexport function formatBytes(bytes, decimals = 2) {\r\n    if (bytes === 0) return \"N/A\";\r\n\r\n    const k = 1024;\r\n    const dm = decimals < 0 ? 0 : decimals;\r\n    const sizes = [\" bytes\", \"KB\", \"MB\", \"GB\", \"TB\"];\r\n\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n    return (bytes / Math.pow(k, i)).toFixed(dm).toLocaleString() + (sizes[i] ?? sizes[sizes.length - 1]);\r\n}","export default class Timer {\r\n    id;\r\n    startTime;\r\n    remainingTime;\r\n    callback;\r\n    duration;\r\n    \r\n    constructor(callback, duration, playAutomatically = true) {\r\n        this.callback = callback;\r\n        this.duration = duration;\r\n        this.remainingTime = duration;\r\n        \r\n        if (playAutomatically)\r\n            this.resume();\r\n    }\r\n    \r\n    resume() {\r\n        this.startTime = Date.now();\r\n        \r\n        clearTimeout(this.id);\r\n        this.id = setTimeout(this.callback, this.remainingTime);\r\n    }\r\n    \r\n    pause() {\r\n        clearTimeout(this.id);\r\n        this.remainingTime -= Date.now() - this.startTime;\r\n    }\r\n    \r\n    end() {\r\n        clearTimeout(this.id);\r\n        this.callback();\r\n    }\r\n}","import React from \"react\";\r\nimport \"./Toasts.scss\";\r\nimport { getRandomKey, joinClassNames } from \"../Classes/Constants\";\r\nimport Timer from \"../Classes/TimerClass\";\r\n\r\nexport function Toast({ children, type, life, remove, callback, color, fixedTime = false }) {\r\n\tconst handleRemove = () => {\r\n\t\tsetClosing(true);\r\n\r\n\t\tsetTimeout(remove, 500);\r\n\t};\r\n\t\r\n\tconst [closing, setClosing] = React.useState(false);\r\n\tconst timer = React.useMemo(() => new Timer(handleRemove, life * 1000, false), []);\r\n\tconst progressBar = React.useRef();\r\n\t\r\n\tconst handleMouseEnter = () => {\r\n\t\ttimer.pause();\r\n\t\tprogressBar.current.style.animationPlayState = \"paused\";\r\n\t};\r\n\t\r\n\tconst handleMouseLeave = () => {\r\n\t\ttimer.resume();\r\n\t\tprogressBar.current.style.animationPlayState = \"running\";\r\n\t};\r\n\t\r\n\tReact.useEffect(() => {\r\n\t\tconst handleFocus = () => !fixedTime && handleMouseLeave();\r\n\t\tconst handleBlur = () => !fixedTime && handleMouseEnter();\r\n\t\t\r\n\t\twindow.addEventListener(\"focus\", handleFocus);\r\n\t\twindow.addEventListener(\"blur\", handleBlur);\r\n\t\t\r\n\t\t(fixedTime || document.hasFocus()) && handleMouseLeave();\r\n\t\t\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"focus\", handleFocus);\r\n\t\t\twindow.removeEventListener(\"blur\", handleBlur);\r\n\t\t};\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<div className={joinClassNames(\"Toast\", [closing, \"Closing\"], type)}\r\n\t\t\t onMouseEnter={fixedTime ? null : handleMouseEnter}\r\n\t\t\t onMouseLeave={fixedTime ? null : handleMouseLeave}\r\n\t\t\t onClick={callback ? e => { callback(e); timer.end(); } : () => { timer.end(); }}\r\n\t\t\t style={{ cursor: callback ? \"pointer\" : null, backgroundColor: color }}>\r\n\t\t\t{ children }\r\n\r\n\t\t\t<div className=\"ProgressBarContainer\">\r\n\t\t\t\t<div ref={progressBar} className=\"ProgressBar\" style={{ animationDuration: life + \"s\" }}/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default class Toasts extends React.Component {\r\n\tstatic instance;\r\n\tstatic ref = React.createRef();\r\n\t\r\n\tstate = { toasts: [] };\r\n\r\n\tcomponentDidMount() {\r\n\t\tToasts.instance = this;\r\n\t}\r\n\t\r\n\tstatic showToast(children, type = \"\", life = 5, additionalOptions = {}) {\r\n\t\tconst { callback = null, color = null, fixedTime = false } = additionalOptions;\r\n\t\t\r\n\t\tconst toast = React.createElement(Toast, {\r\n\t\t\tkey: getRandomKey(),\r\n\t\t\tchildren, type, life, color, fixedTime,\r\n\t\t\tremove: () => {\r\n\t\t\t\tthis.instance.setState({ toasts: this.instance.state.toasts.filter(t => t !== toast) });\r\n\t\t\t},\r\n\t\t\tcallback\r\n\t\t});\r\n\r\n\t\tthis.instance.setState({ toasts: [ ...this.instance.state.toasts, toast ] });\r\n\t\treturn toast;\r\n\t}\r\n\t\r\n\tget horizontalStyle() {\r\n\t\treturn \"Center\";\r\n\t\t\r\n\t\t// switch (Settings.props.notifications.toasts.positionX) {\r\n\t\t// \tcase 0:\r\n\t\t// \t\treturn \"Left\";\r\n\t\t// \tcase 1:\r\n\t\t// \t\treturn \"Center\";\r\n\t\t// \tcase 2:\r\n\t\t// \t\treturn \"Right\";\r\n\t\t// }\r\n\t}\r\n\t\r\n\tget verticalStyle() {\r\n\t\treturn \"Bottom\";\r\n\t\t\r\n\t\t// switch (Settings.props.notifications.toasts.positionY) {\r\n\t\t// \tcase 0:\r\n\t\t// \t\treturn \"Top\";\r\n\t\t// \tcase 1:\r\n\t\t// \t\treturn \"Bottom\";\r\n\t\t// }\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div ref={Toasts.ref} className={joinClassNames(\"ToastsContainer\", this.horizontalStyle, this.verticalStyle)}>\r\n\t\t\t\t<div className={joinClassNames(\"ClearButton\", [!!this.state.toasts?.length, \"Visible\"])} onClick={() => this.setState({ toasts: [] })}>\r\n\t\t\t\t\t<u>Close all</u>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t{ this.state.toasts }\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport \"./Modals.scss\";\r\nimport ErrorBoundary from \"./ErrorBoundary\";\r\nimport Toasts from \"./Toasts\";\r\nimport InlineLoading from \"./InlineLoading\";\r\nimport { getRandomKey, joinClassNames } from \"../Classes/Constants\";\r\nimport Tooltip from \"./Tooltip\";\r\nimport LinkWrapper from \"./LinkWrapper\";\r\nimport * as Feather from \"react-feather\";\r\nimport { useEventListener, useOnMount, useOnUnmount } from \"../Classes/Hooks\";\r\nimport QueryManager from \"../Classes/QueryManager\";\r\nimport { lastHistoryPop } from \"../App\";\r\n\r\n/**\r\n * Pushes a component to the modal stack.\r\n * @deprecated Use Modals.push(modal) instead.\r\n * @param modal The React component modal.\r\n */\r\nexport function openModal(modal) {\r\n\tModals.push(modal);\r\n}\r\n\r\n/**\r\n * Close the last modal in the stack.\r\n * @deprecated Use Modals.pop() instead.\r\n */\r\nexport function closeModal() {\r\n\tModals.pop().catch(console.error.bind(console, \"Failed to pop modal!\"));\r\n}\r\n\r\n/**\r\n * Copies the specified text to the clipboard\r\n * @param text The text to copy.\r\n * @returns {Promise<void>}\r\n */\r\nexport async function copyToClipboard(text) {\r\n\ttry {\r\n\t\tawait window.navigator.clipboard.writeText(text);\r\n\r\n\t\tToasts.showToast(<span><b>{text.length >= 100 ? text.substr(0, 100) + \"...\" : text}</b> copied to clipboard</span>, \"Success\");\r\n\t}\r\n\tcatch (e) {\r\n\t\topenStringModal({\r\n\t\t\ttitle: \"Failed To Copy\",\r\n\t\t\tdescription: \"Your browser does not support copying to clipboard, you can manually copy here.\",\r\n\t\t\tvalue: text\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction ImageComponent({ image, setLoaded, setFailed, className, onClick }) {\r\n\tconst ref = React.useRef();\r\n\tconst [loaded, _setLoaded] = React.useState(false);\r\n\r\n\tconst events = {\r\n\t\tonLoad: () => (setLoaded?.(true), setFailed?.(false), _setLoaded(true)),\r\n\t\tonError: () => (setLoaded?.(true), setFailed?.(true), _setLoaded(true)),\r\n\t\tonClick\r\n\t};\r\n\r\n\tuseOnUnmount(() => {\r\n\t\tif (ref.current) {\r\n\t\t\tref.current.pause();\r\n\t\t}\r\n\t});\r\n\r\n\tif (!image) return null;\r\n\r\n\treturn /\\.webm$/.test(image.full)\r\n\t\t? <video\r\n\t\t\tref={ref}\r\n\t\t\tsrc={image.full}\r\n\t\t\tcontrols={!className}\r\n\t\t\tloop\r\n\t\t\tmuted\r\n\t\t\tclassName={className}\r\n\t\t\t{...events}\r\n\t\t/> : (\r\n\t\t\t<>\r\n\t\t\t\t<img src={image.preview} alt=\"Preview failed to load\"\r\n\t\t\t\t\tstyle={{ display: loaded && !className ? \"none\" : null }} className={className} />\r\n\r\n\t\t\t\t{!className && <img src={image.full} alt=\"Image failed to load\" className={className}\r\n\t\t\t\t\tstyle={{ display: loaded ? null : \"none\" }} {...events} />}\r\n\t\t\t</>\r\n\t\t);\r\n}\r\n\r\nexport function ImageModal({ url, getSources, buttons }) {\r\n\t// Get the sources or create a single-item array\r\n\tconst sources = typeof (getSources) === \"function\" ? getSources().filter(u => u) : [url];\r\n\r\n\tconst ref = React.useRef();\r\n\tconst container = React.useRef();\r\n\r\n\t// Create a state based on the index of the current url\r\n\tconst [index, _setIndex] = React.useState(sources.findIndex(f => f.full === url));\r\n\tfunction setIndex(index) {\r\n\t\t// We don't talk about this in my job interview.\r\n\t\tdocument.querySelector(`[src=\"${sources[index].preview}\"]`)?.scrollIntoView();\r\n\r\n\t\t_setIndex(index);\r\n\t}\r\n\r\n\t// Handle the modal state query.\r\n\tReact.useEffect(() => {\r\n\t\tQueryManager.set(\"modalState\", \"open\");\r\n\r\n\t\treturn () => Date.now() - lastHistoryPop > 500 && window.history.back();\r\n\t}, []);\r\n\r\n\tReact.useEffect(() => {\r\n\t\tcontainer && container.current.style.setProperty(\"--translation\", \"0\");\r\n\t}, [container, index]);\r\n\r\n\t// Create a navigate function to handle safely navigating images\r\n\tconst nav = dir =>\r\n\t\tsources[index + dir]\r\n\t\t\t? (setLoaded(false), setFailed(false), setIndex(index + dir))\r\n\t\t\t: Toasts.showToast(\"No more images in this direction!\", \"Failure\");\r\n\t// Create an expanded state based on the serialized settings state\r\n\tconst [expanded, setExpandedState] = React.useState(true);\r\n\r\n\t// These are placeholders, I'm too lazy to add them\r\n\tconst [loaded, setLoaded] = React.useState(false);\r\n\tconst [failed, setFailed] = React.useState(false);\r\n\r\n\t// Handle keyboard navigation/controls.\r\n\tuseEventListener(\"keydown\", ({ key }) => {\r\n\t\tswitch (key) {\r\n\t\t\tcase \"Escape\": return Modals.pop();\r\n\t\t\tcase \"ArrowLeft\": return nav(-1);\r\n\t\t\tcase \"ArrowRight\": return nav(1);\r\n\t\t}\r\n\t}, { dependencies: [index] });\r\n\r\n\t// Handle touch controls\r\n\tconst mobileEvents = {\r\n\t\tonTouchStart: e => {\r\n\t\t\tconst tapX = e.touches[0].clientX;\r\n\t\t\tconst tapY = e.touches[0].clientY;\r\n\r\n\t\t\tlet translation = 0;\r\n\r\n\t\t\tconst handler = e => {\r\n\t\t\t\tconst alias = 50;\r\n\t\t\t\ttranslation = e.touches[0].clientX - tapX;\r\n\r\n\t\t\t\tif (Math.abs(translation) < alias) return;\r\n\t\t\t\tif (translation < 0) translation += alias;\r\n\t\t\t\telse translation -= alias;\r\n\r\n\t\t\t\ttranslation /= window.innerWidth;\r\n\t\t\t\ttranslation *= 100;\r\n\r\n\t\t\t\tcontainer.current.style.setProperty(\r\n\t\t\t\t\t\"--translation\",\r\n\t\t\t\t\ttranslation\r\n\t\t\t\t);\r\n\t\t\t};\r\n\r\n\t\t\tdocument.addEventListener(\"touchmove\", handler);\r\n\r\n\t\t\tlet remove;\r\n\t\t\tdocument.addEventListener(\"touchend\", remove = () => {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tconst translation = parseFloat(container.current.style.getPropertyValue(\"--translation\"));\r\n\t\t\t\t\tcontainer.current.style.setProperty(\r\n\t\t\t\t\t\t\"--translation\",\r\n\t\t\t\t\t\ttranslation > 25\r\n\t\t\t\t\t\t\t? \"100\"\r\n\t\t\t\t\t\t\t: translation < -25\r\n\t\t\t\t\t\t\t\t? \"-100\"\r\n\t\t\t\t\t\t\t\t: \"0\"\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tdocument.removeEventListener(\"touchmove\", handler);\r\n\t\t\t\t\tdocument.removeEventListener(\"touchend\", remove);\r\n\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tif (!container.current) return;\r\n\r\n\t\t\t\t\t\tconst translation = parseFloat(container.current.style.getPropertyValue(\"--translation\"));\r\n\t\t\t\t\t\tif (translation >= 75) {\r\n\t\t\t\t\t\t\tnav(-1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (translation <= -75) {\r\n\t\t\t\t\t\t\tnav(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}, 100);\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t// Render bender\r\n\treturn (\r\n\t\t<div ref={container} className=\"ImageModal\" onClick={e => e.target === e.currentTarget && Modals.pop()} {...mobileEvents}>\r\n\t\t\t<div className={joinClassNames(\"ImageContainer\", [expanded, \"Expanded\"])}>\r\n\t\t\t\t<ImageComponent\r\n\t\t\t\t\tkey={getRandomKey()}\r\n\t\t\t\t\timage={sources[index - 1]}\r\n\t\t\t\t\tsetLoaded={setLoaded}\r\n\t\t\t\t\tsetFailed={setFailed}\r\n\r\n\t\t\t\t\tclassName=\"Previous\"\r\n\t\t\t\t\tonClick={() => nav(-1)}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<ImageComponent\r\n\t\t\t\t\tkey={getRandomKey()}\r\n\t\t\t\t\timage={sources[index]}\r\n\t\t\t\t\tsetLoaded={setLoaded}\r\n\t\t\t\t\tsetFailed={setFailed}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<ImageComponent\r\n\t\t\t\t\tkey={getRandomKey()}\r\n\t\t\t\t\timage={sources[index + 1]}\r\n\t\t\t\t\tsetLoaded={setLoaded}\r\n\t\t\t\t\tsetFailed={setFailed}\r\n\r\n\t\t\t\t\tclassName=\"Next\"\r\n\t\t\t\t\tonClick={() => nav(1)}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"Footer\">\r\n\t\t\t\t<div className={joinClassNames(\"Button Arrow Left\",\r\n\t\t\t\t\t[!sources.length || !index, \"Disabled\"])} onClick={() => nav(-1)}>\r\n\t\t\t\t\t<Feather.ChevronLeft />\r\n\t\t\t\t\t<Tooltip>Previous Image</Tooltip>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"Divider\" />\r\n\r\n\t\t\t\t{buttons?.(index) ?? (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div className=\"Button\" onClick={() => (setExpandedState(!expanded))}>\r\n\t\t\t\t\t\t\t{expanded ? <Feather.Minimize /> : <Feather.Maximize />}\r\n\t\t\t\t\t\t\t<Tooltip>{expanded ? \"Compress\" : \"Expand\"}</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"Button\">\r\n\t\t\t\t\t\t\t<Feather.Clipboard />\r\n\t\t\t\t\t\t\t<Tooltip>Copy URL</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<LinkWrapper className=\"Button\" style={{ display: \"block\", color: \"white\" }}\r\n\t\t\t\t\t\t\thref={sources[index].full}>\r\n\t\t\t\t\t\t\t<Feather.ExternalLink />\r\n\t\t\t\t\t\t\t<Tooltip>Open In New Tab</Tooltip>\r\n\t\t\t\t\t\t</LinkWrapper>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className=\"Divider\" />\r\n\r\n\t\t\t\t<div className={joinClassNames(\"Button Arrow Right\",\r\n\t\t\t\t\t[!sources.length || index + 1 >= sources.length, \"Disabled\"])} onClick={() => nav(1)}>\r\n\t\t\t\t\t<Feather.ChevronRight />\r\n\t\t\t\t\t<Tooltip>Next Image</Tooltip>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/**\r\n * Pushes an image modal to the modal stack.\r\n * @param url The URI for the image to focus.\r\n * @param getSources? An option callback function that returns an array of URIs.\r\n */\r\nexport function openImageModal(url, getSources = null, options = {}) {\r\n\tModals.push(<ImageModal url={url} getSources={getSources} {...options} />);\r\n}\r\n\r\n/**\r\n * Displays a two-choice modal to the user.\r\n * @param title\r\n * @param description\r\n * @param yesText\r\n * @param noText\r\n * @param yesColor\r\n * @param noColor\r\n * @returns {Promise<boolean>}\r\n */\r\nexport async function openBoolModal({\r\n\ttitle = \"\",\r\n\tdescription = \"\",\r\n\tyesText = \"Yes\",\r\n\tnoText = \"No\",\r\n\tyesColor = \"#ff6666\",\r\n\tnoColor = \"\"\r\n}) {\r\n\tconst response = await new Promise(resolve => {\r\n\t\tModals.push(\r\n\t\t\t<div className=\"BoolModal PrimaryBg\">\r\n\t\t\t\t<div className=\"Title\" dangerouslySetInnerHTML={{ __html: title }} />\r\n\t\t\t\t<div className=\"Description\" dangerouslySetInnerHTML={{ __html: description }} />\r\n\r\n\t\t\t\t<div className=\"Footer\">\r\n\t\t\t\t\t<div className=\"Button TertiaryBg\" onClick={() => resolve(false)} style={{ backgroundColor: noColor }}>{noText}</div>\r\n\t\t\t\t\t<div className=\"Button TertiaryBg\" onClick={() => resolve(true)} style={{ backgroundColor: yesColor }}>{yesText}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t});\r\n\r\n\tModals.pop();\r\n\r\n\treturn response;\r\n}\r\n\r\n/**\r\n * Displays a string choice modal to the user.\r\n * @param options\r\n * @returns {Promise<string | null>}\r\n */\r\nexport async function openStringModal(options = {}) {\r\n\tconst { async = false } = options;\r\n\r\n\tconst response = await new Promise(resolve => {\r\n\t\tModals.push(\r\n\t\t\t<StringModal resolve={resolve} {...options} />\r\n\t\t);\r\n\t});\r\n\r\n\t!async && Modals.pop();\r\n\r\n\treturn response;\r\n}\r\n\r\nexport class Modals extends React.Component {\r\n\tstatic instance;\r\n\r\n\t/**\r\n\t * Pushes a component to the modal stack.\r\n\t * @param modal The React component modal.\r\n\t */\r\n\tstatic push(modal) {\r\n\t\tthis.instance.setState({ stack: [...this.instance.state.stack, modal] });\r\n\t}\r\n\r\n\t/**\r\n\t * Closes the last modal in the stack.\r\n\t * @returns {Promise<void>}\r\n\t */\r\n\tstatic async pop() {\r\n\t\t// Destructure the instance state\r\n\t\tconst { stack, closing } = this.instance.state;\r\n\t\tconst modal = stack[stack.length - 1];\r\n\r\n\t\t// If there is nothing to close, return\r\n\t\tif (!stack.length || !modal) return;\r\n\r\n\t\t// Push the modal to the closing state, activating the transition\r\n\t\tthis.instance.setState({ closing: [...closing, modal] });\r\n\r\n\t\t// Wait for the transition\r\n\t\tawait new Promise(r => setTimeout(r, 150));\r\n\r\n\t\t// Set the new state, removing the modal from both stack states\r\n\t\tthis.instance.setState({\r\n\t\t\tstack: this.instance.state.stack.filter(m => m !== modal),\r\n\t\t\tclosing: this.instance.state.closing.filter(m => m !== modal)\r\n\t\t});\r\n\t}\r\n\r\n\tstate = { stack: [], closing: [] };\r\n\r\n\tcomponentDidMount() {\r\n\t\t// Assign the static instance variable\r\n\t\tModals.instance = this;\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\r\n\t\tdocument.documentElement.style.overflowY = this.state.stack.length ? \"hidden\" : null;\r\n\t\tdocument.documentElement.style.marginRight = this.state.stack.length ? \"5px\" : null;\r\n\t}\r\n\r\n\thandleBackdropClick(e) {\r\n\t\t// Ensure that we're actually clicking the modal background\r\n\t\tif (e.target !== e.currentTarget) return;\r\n\r\n\t\t// If the modal has an on backdrop click prop, run it and return\r\n\t\tconst { stack } = this.state;\r\n\t\tif (stack[stack.length - 1] && typeof (stack[stack.length - 1].props?.onBackdropClick) === \"function\")\r\n\t\t\treturn stack[stack.length - 1].props.onBackdropClick();\r\n\r\n\t\t// K I L L\r\n\t\tModals.pop().catch(console.error.bind(console, \"Failed to pop modal!\"));\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { stack, closing } = this.state;\r\n\r\n\t\treturn (\r\n\t\t\t<div className={\"ModalStack\" + (stack.length > closing.length ? \" Active\" : \"\")}>\r\n\t\t\t\t{stack.map((modal, id) => (\r\n\t\t\t\t\t<ErrorBoundary>\r\n\t\t\t\t\t\t<div className={\"ModalContainer\" +\r\n\t\t\t\t\t\t\t(~closing.indexOf(modal) || id < stack.length - 1 ? \" Closing\" : \"\")}\r\n\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\tonMouseDown={this.handleBackdropClick.bind(this)}\r\n\t\t\t\t\t\t\tstyle={{ zIndex: id * 10 }}>{modal}</div>\r\n\t\t\t\t\t</ErrorBoundary>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport function StringModal(props) {\r\n\tconst { title = \"\", description = \"\", yesText = \"Confirm\", noText = \"Cancel\", yesColor = \"\", noColor = \"\", value = \"\", onChange = null, rich = false, resolve, id } = props;\r\n\tconst [no, setNoState] = React.useState(false);\r\n\tconst [yes, setYesState] = React.useState(false);\r\n\r\n\treturn (\r\n\t\t<div className=\"StringModal PrimaryBg\">\r\n\t\t\t<div className=\"Title\" dangerouslySetInnerHTML={{ __html: title }} />\r\n\t\t\t<div className=\"Description\" dangerouslySetInnerHTML={{ __html: description }} />\r\n\r\n\t\t\t<input id={id} className=\"Field TertiaryBg\" defaultValue={value} onChange={onChange} />\r\n\r\n\t\t\t<div className=\"Footer\">\r\n\t\t\t\t<div className=\"Button TertiaryBg\" onClick={() => (resolve(null), setNoState(true))} style={{ backgroundColor: noColor }}>{no ? <InlineLoading /> : noText}</div>\r\n\t\t\t\t<div className=\"Button TertiaryBg\" onClick={() => (resolve(document.getElementById(id).value), setYesState(true))} style={{ backgroundColor: yesColor }}>{yes ? <InlineLoading /> : yesText}</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}","import App from \"../App\";\r\nimport Toasts from \"../Components/Toasts\";\r\n\r\nexport default new class E621API {\r\n    endpoint = \"https://e621.net/\";\r\n    \r\n    get loginData() {\r\n        return {\r\n            login: App.userData.username,\r\n            api_key: App.userData.apiKey\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Gets a request-able URL to the E621 API endpoint.\r\n     * @param sub {string} The page to request.\r\n     * @param args The arguments to pass to the request as a string.\r\n     * @param json {boolean} Whether to request from the json endpoint.\r\n     * @returns {string} An endpoint URL.\r\n     */\r\n    getEndpoint(sub, args = {}, json = true) {\r\n        // Get the stored login data.\r\n        let login = this.loginData;\r\n        // If the login or api key is null, then clean the login object.\r\n        if (!login.login || !login.api_key) login = {};\r\n        \r\n        // Create the request params object.\r\n        const params = new URLSearchParams({\r\n            ...login,\r\n            ...args,\r\n            _client: \"Sucralose/2.0 by Metalloriff\"\r\n        });\r\n        \r\n        // Return the request string.\r\n        return `${this.endpoint}${sub}${json ? \".json?\" : \"?\"}${params}`;\r\n    }\r\n    \r\n    /**\r\n     * Make a request to the E621 API endpoint.\r\n     * @param sub {string} The page to request from the E621 API endpoint.\r\n     * @param args The arguments to pass to the request as a string.\r\n     * @param json {boolean} Whether to request from the json endpoint.\r\n     * @param restOptions The options argument to pass to the fetch request.\r\n     * @returns {Promise<any>} A promise that resolves when the request has been made.\r\n     */\r\n    async request(sub, args = {}, json = true, restOptions = {}) {\r\n        // Rate limit for requests made.\r\n        while (Date.now() - this.lastMadeRequest < 500)\r\n            await new Promise(r => setTimeout(r, 100));\r\n        // Set the last made request to the current time.\r\n        this.lastMadeRequest = Date.now();\r\n        \r\n        // Return the response object.\r\n        return await fetch(this.getEndpoint(sub, args, json), restOptions)\r\n            .then(response => json ? response.json() : response);\r\n    }\r\n\r\n    /**\r\n     * The last time a request was made to the E621 API endpoint.\r\n     * @type {number}\r\n     */\r\n    lastMadeRequest = -500;\r\n\r\n    #voting = { };\r\n\r\n    /**\r\n     * Handles voting/un-voting on a post.\r\n     * @param postId {number} The ID of the post.\r\n     * @param score {number | \"-1\" | \"1\"} The score to assign to the post.\r\n     * @returns {Promise<*>}\r\n     */\r\n    async vote(postId, score) {\r\n        // If the user is not signed in, throw an error and return.\r\n        if (!App.userData.username || !App.userData.apiKey)\r\n            return Toasts.showToast(\"You must be logged into e621 to favorite posts\", \"Failure\");\r\n        \r\n        // If we're already trying to vote on this post, throw an error and return.\r\n        if (this.#voting[postId])\r\n            return Toasts.showToast(\"You're attempting to vote too quickly\", \"Failure\");\r\n        this.#voting[postId] = true;\r\n        \r\n        // Make the request to the E621 API.\r\n        return await this.request(\r\n            `posts/${postId}/votes`,\r\n            { score, no_unvote: false },\r\n            true,\r\n            { method: \"POST\" }\r\n        ).then(r => (delete this.#voting[postId], r));\r\n    }\r\n    \r\n    #favoriting = { };\r\n\r\n    /**\r\n     * Handles adding a post to the user's favorites.\r\n     * @param postId {number} The ID of the post to add.\r\n     * @returns {Promise<*>}\r\n     */\r\n    async favorite(postId) {\r\n        // If the user is not signed in, throw an error and return.\r\n        if (!App.userData.username || !App.userData.apiKey)\r\n            return Toasts.showToast(\"You must be logged into e621 to favorite posts\", \"Failure\");\r\n        \r\n        // If we're already trying to favorite this post, throw an error and return.\r\n        if (this.#favoriting[postId])\r\n            return Toasts.showToast(\"You're attempting to favorite too quickly\", \"Failure\");\r\n        this.#favoriting[postId] = true;\r\n        \r\n        // Make the request to the E621 API.\r\n        return await this.request(\r\n            \"favorites\",\r\n            { post_id: postId },\r\n            true,\r\n            { method: \"POST\" }\r\n        ).then(r => (delete this.#favoriting[postId], r));\r\n    }\r\n\r\n    /**\r\n     * Handles deleting a post from the user's favorites.\r\n     * @param postId {number} The ID of the post to remove.\r\n     * @returns {Promise<*>}\r\n     */\r\n    async removeFavorite(postId) {\r\n        // If the user is not signed in, throw an error and return.\r\n        if (!App.userData.username || !App.userData.apiKey)\r\n            return Toasts.showToast(\"You must be logged into e621 to favorite posts!\");\r\n\r\n        // If we're already trying to favorite this post, throw an error and return.\r\n        if (this.#favoriting[postId])\r\n            return Toasts.showToast(\"You're attempting to favorite too quickly\", \"Failure\");\r\n        this.#favoriting[postId] = true;\r\n        \r\n        // Make the request to the E621 API.\r\n        return await this.request(\r\n            `favorites/${postId}.json`,\r\n            { },\r\n            false,\r\n            { method: \"DELETE\" }\r\n        ).then(r => (delete this.#favoriting[postId], r));\r\n    }\r\n}","import React from \"react\";\r\nimport \"./Tooltip.scss\";\r\nimport { joinClassNames } from \"../Classes/Constants\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nexport default function Tooltip({ children, direction = \"up\", className = \"\", color, style, onClick }) {\r\n    const [visible, setVisible] = React.useState(false);\r\n    const ref = React.useRef();\r\n    \r\n    React.useEffect(() => {\r\n        ref.current.parentElement.classList.add(\"HasTooltip\");\r\n        \r\n        return () => {\r\n            ref.current && ref.current.parentElement.classList.remove(\"HasTooltip\");\r\n        };\r\n    }, [ children, direction ]);\r\n    \r\n    return (\r\n        <div ref={ref} className={joinClassNames(\"TooltipContainer\", direction.toLowerCase(), [visible, \"Visible\"], className)} style={style} onClick={onClick}>\r\n            <div className=\"Tooltip\" style={{ backgroundColor: color }}>{ children }</div>\r\n            <div className=\"TooltipArrow\" style={{ backgroundColor: color }}/>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function DetachedTooltip({ children, direction = \"up\", className = \"\", color, style, onClick, parentRef }) {\r\n    const container = React.useMemo(() => document.getElementsByClassName(\"AppMain\")[0], []);\r\n    const [visible, setVisible] = React.useState(false);\r\n    const [styles, setStyles] = React.useState(null);\r\n    const ref = React.useRef();\r\n\r\n    React.useEffect(() => {\r\n        const parent = parentRef.current;\r\n        \r\n        const events = {\r\n            onMouseEnter: () => {\r\n                if (visible) return;\r\n                \r\n                const rect = parent.getBoundingClientRect();\r\n                const tooltipRect = ref.current.getBoundingClientRect();\r\n                \r\n                switch (direction) {\r\n                    case \"up\":\r\n                        setStyles({\r\n                            top: rect.y - rect.height - tooltipRect.height,\r\n                            left: rect.x + (rect.width / 2)\r\n                        });\r\n                        break;\r\n\r\n                    case \"left\":\r\n                        setStyles({\r\n                            top: rect.y - (rect.height / 2) + ((tooltipRect.height * 1.25) / 3),\r\n                            left: rect.x - (tooltipRect.width * 1.25)\r\n                        });\r\n                        break;\r\n                        \r\n                    case \"down\":\r\n                        setStyles({\r\n                            bottom: rect.y - (tooltipRect.height * 1.25),\r\n                            left: rect.x - ((tooltipRect.width * 1.25) / 2) + (rect.width / 2)\r\n                        });\r\n                        break;\r\n                        \r\n                    case \"right\":\r\n                        setStyles({\r\n                            top: rect.y - ((tooltipRect.height * 1.25) / 2) + (rect.height / 2),\r\n                            right: rect.x - tooltipRect.width - 5\r\n                        });\r\n                        break;\r\n                }\r\n                \r\n                setVisible(true);\r\n            },\r\n            onMouseLeave: () => setVisible(false)\r\n        };\r\n        \r\n        parent.addEventListener(\"mouseenter\", events.onMouseEnter);\r\n        parent.addEventListener(\"mouseleave\", events.onMouseLeave);\r\n        \r\n        return () => {\r\n            parent.removeEventListener(\"mouseenter\", events.onMouseEnter);\r\n            parent.removeEventListener(\"mouseleave\", events.onMouseLeave);\r\n        };\r\n    }, [ children, direction ]);\r\n\r\n    return ReactDOM.createPortal(\r\n        <div ref={ref} className={joinClassNames(\"TooltipContainer Detached\", direction.toLowerCase(), [visible, \"Visible\"], className)}\r\n             style={{ ...(styles ?? {}), ...(style ?? {}) }} onClick={onClick}>\r\n            <div className=\"Tooltip\" style={{ backgroundColor: color }}>{ children }</div>\r\n            <div className=\"TooltipArrow\" style={{ backgroundColor: color }}/>\r\n        </div>,\r\n        container\r\n    );\r\n}","export default __webpack_public_path__ + \"static/media/Chevron.c3ee4024.svg\";","import React, { createRef } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./ContextMenuHandler.scss\";\r\n\r\nimport ChevronIcon from \"../Icons/Chevron.svg\";\r\nimport ErrorBoundary from \"./ErrorBoundary\";\r\n\r\nfunction exclude(object, ...exclusions) {\r\n\tconst output = Object.assign({}, object);\r\n\r\n\tfor (const exclusion of exclusions) delete output[exclusion];\r\n\treturn output;\r\n}\r\n\r\nclass ContextMenu extends React.Component {\r\n\tref = createRef();\r\n\r\n\tdocClickEv = e => {\r\n\t\tif (this.ref.current && !this.ref.current.contains(e.target) && !document.getElementsByClassName(\"ContextMenu\")[0].contains(e.target)) {\r\n\t\t\tthis.close();\r\n\t\t}\r\n\t}\r\n\r\n\tclose() {\r\n\t\tif (ContextMenu.activeWrapper) {\r\n\t\t\tContextMenu.activeWrapper.setState({ menu: null, open: false });\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tdocument.addEventListener(\"click\", this.docClickEv);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tdocument.removeEventListener(\"click\", this.docClickEv);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorBoundary>\r\n\t\t\t\t<div className=\"ContextMenu\" {...this.props} ref={this.ref}>\r\n\t\t\t\t\t{ this.props.children }\r\n\t\t\t\t</div>\r\n\t\t\t</ErrorBoundary>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nContextMenu.Handler = class extends React.Component {\r\n\tstatic ref = createRef();\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorBoundary>\r\n\t\t\t\t<div ref={ContextMenu.Handler.ref} className=\"ContextMenuWrapper MainContextMenuContainer\">\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t</ErrorBoundary>\r\n\t\t);\r\n\t}\r\n};\r\n\r\nContextMenu.Wrapper = class extends React.Component {\r\n\tstate = { menu: null, open: false };\r\n\tref = createRef();\r\n\t\r\n\tget publicProps() {\r\n\t\treturn exclude(this.props, \"menu\", \"openOnClick\", \"wrapperClassName\", \"overrideX\", \"overrideY\");\r\n\t}\r\n\r\n\thandleContextMenu = e => {\r\n\t\tif (typeof(e.preventDefault) === \"function\")\r\n\t\t\te.preventDefault();\r\n\r\n\t\tif (ContextMenu.activeWrapper) {\r\n\t\t\tif (this.ref.current.contains(ContextMenu.activeWrapper.ref.current) && ContextMenu.activeWrapper.props.menu !== this.props.menu)\r\n\t\t\t\treturn;\r\n\t\t\tContextMenu.activeWrapper.setState({ menu: null, open: false });\r\n\t\t}\r\n\r\n\t\tContextMenu.activeWrapper = this;\r\n\t\t\r\n\t\tlet top = this.props.menu.props.overrideY?.() || e.clientY;\r\n\t\tlet left = this.props.menu.props.overrideX?.() || e.clientX;\r\n\t\t\r\n\t\twhile (left + 200 > window.innerWidth)\r\n\t\t\tleft -= 10;\r\n\t\t\r\n\t\tthis.setState({ menu: ReactDOM.createPortal(\r\n\t\t\t\t<div className=\"ContextMenuContainer SecondaryBg\" {...this.publicProps} style={{\r\n\t\t\t\t\tposition: \"fixed\",\r\n\t\t\t\t\ttop, left \r\n\t\t\t\t}}>{ this.props.menu }</div>, ContextMenu.Handler.ref.current), open: true });\r\n\t}\r\n\r\n\tasync componentDidUpdate(prevProps, prevState, snapshot) {\r\n\t\tif (ContextMenu.activeWrapper === this && !this.state.open)\r\n\t\t\tContextMenu.activeWrapper = null;\r\n\t\t\r\n\t\tif (this.state.open && this.ref.current) {\r\n\t\t\tconst [ menu ] = document.getElementsByClassName(\"ContextMenuContainer\");\r\n\t\t\tconst rect = menu.getBoundingClientRect();\r\n\t\t\t\r\n\t\t\tmenu.style.transform = rect.y + rect.height > window.innerHeight\r\n\t\t\t\t? `translateY(${window.innerHeight - (rect.y + rect.height) - 20}px)`\r\n\t\t\t\t: null;\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn this.props.menu ? (\r\n\t\t\t<ErrorBoundary>\r\n\t\t\t\t<div ref={this.ref} className={\"ContextMenuWrapper \" + (this.props.wrapperClassName || \"\")} onClick={this.props.openOnClick ? e => {\r\n\t\t\t\t\tif (typeof(e.target.onClick) === \"function\")\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.handleContextMenu(this.props.openOnClick());\r\n\t\t\t\t} : null}\r\n\t\t\t\t\t {...this.publicProps} onContextMenu={this.handleContextMenu}>\r\n\t\t\t\t\t{ this.props.children }\r\n\t\t\t\t\t\r\n\t\t\t\t\t<ErrorBoundary>\r\n\t\t\t\t\t\t{ this.state.open ? this.state.menu : null }\r\n\t\t\t\t\t</ErrorBoundary>\r\n\t\t\t\t</div>\r\n\t\t\t</ErrorBoundary>\r\n\t\t) : this.props.children;\r\n\t}\r\n}\r\n\r\nContextMenu.Item = class extends React.Component {\r\n\thandleClick = e => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\t\r\n\t\tif (ContextMenu.activeWrapper && this.props.autoClose) {\r\n\t\t\tContextMenu.activeWrapper.setState({ menu: null, open: false });\r\n\t\t}\r\n\r\n\t\tif (this.props.onClick) {\r\n\t\t\tthis.props.onClick(this);\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst props = Object.assign({}, this.props);\r\n\r\n\t\tdelete props.autoClose;\r\n\t\tdelete props.icon;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"ContextMenuItem\" {...props} onClick={this.handleClick}>\r\n\t\t\t\t{ this.props.icon }\r\n\t\t\t\t\r\n\t\t\t\t{ this.props.children }\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nContextMenu.SubMenuItem = class extends React.Component {\r\n\tstate = { open: false };\r\n\r\n\thandleMouseEnter = () => {\r\n\t\tthis.setState({ open: true });\r\n\t}\r\n\r\n\thandleMouseLeave = () => {\r\n\t\tthis.setState({ open: false });\r\n\t}\r\n\r\n\thandleClick = e => {\r\n\t\tif (e.target !== e.currentTarget) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (ContextMenu.activeWrapper && this.props.autoClose) {\r\n\t\t\tContextMenu.activeWrapper.setState({ menu: null, open: false });\r\n\t\t}\r\n\r\n\t\tif (this.props.onClick) {\r\n\t\t\tthis.props.onClick(this);\r\n\t\t}\r\n\t}\r\n\t\r\n\tmount(menu) {\r\n\t\tif (!menu) return;\r\n\t\tconst rect = menu.getBoundingClientRect();\r\n\r\n\t\tmenu.style.transform = rect.y + rect.height > window.innerHeight\r\n\t\t\t? `translateY(${window.innerHeight - (rect.y + rect.height) - 20}px)`\r\n\t\t\t: null;\r\n\t\t\r\n\t\tif (rect.x + rect.width > window.innerWidth) {\r\n\t\t\tmenu.style.left = \"unset\";\r\n\t\t\tmenu.style.right = \"100%\";\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst props = Object.assign({}, this.props);\r\n\r\n\t\tdelete props.autoClose;\r\n\t\tdelete props.label;\r\n\t\tdelete props.icon;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"ContextMenuItem HasSubMenu\" {...props} onClick={this.handleClick} onMouseEnter={this.handleMouseEnter} onMouseLeave={this.handleMouseLeave}>\r\n\t\t\t\t{ this.props.icon }\r\n\t\t\t\t{ this.props.label } <img className=\"ContextSubMenuChevron\" src={ChevronIcon}/>\r\n\t\t\t\t{ this.state.open ? (\r\n\t\t\t\t\t<div className=\"ContextMenuContainer SubMenuContainer SecondaryBg\" ref={this.mount}>\r\n\t\t\t\t\t\t<div className=\"ContextMenu SubMenu\">\r\n\t\t\t\t\t\t\t{ this.props.children }\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : null }\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nContextMenu.ToggleItem = class extends React.Component {\r\n\tstate = { checked: false };\r\n\r\n\tcallback = () => {\r\n\t\tif (ContextMenu.activeWrapper && this.props.autoClose) {\r\n\t\t\tContextMenu.activeWrapper.setState({ menu: null, open: false });\r\n\t\t}\r\n\r\n\t\tconst checked = !this.state.checked;\r\n\r\n\t\tif (this.props.callback) {\r\n\t\t\tthis.props.callback(checked);\r\n\t\t}\r\n\r\n\t\tthis.setState({ checked });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setState({ checked: this.props.checked });\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst props = Object.assign({}, this.props);\r\n\r\n\t\tdelete props.autoClose;\r\n\t\tdelete props.callback;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"ContextMenuItem ToggleItem\" {...props} onClick={this.callback}>\r\n\t\t\t\t<div className={\"ToggleBox\" + (this.state.checked ? \" Checked\" : \"\")}>\r\n\t\t\t\t\t{ this.state.checked ? (<div className=\"ToggleBoxTick\"/>) : null }\r\n\t\t\t\t</div>\r\n\t\t\t\t{ this.props.children }\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nContextMenu.Divider = class extends React.Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"ContextMenuDivider\" {...this.props}/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default ContextMenu;","function fromEntries(entries) {\r\n    const obj = { };\r\n    \r\n    for (const [key, value] of entries) {\r\n        obj[key] = value;\r\n    }\r\n    \r\n    return obj;\r\n}\r\n\r\nexport default new class QueryManager {\r\n    get query() {\r\n        return fromEntries(\r\n            new URLSearchParams(window.location.search)\r\n        );\r\n    }\r\n    \r\n    get(key, def = null) {\r\n        return this.query[key] ?? def;\r\n    }\r\n    \r\n    set(key, value, options = {}) {\r\n        const {\r\n            pushHistory = true\r\n        } = options;\r\n        \r\n        const query = new URLSearchParams(window.location.search);\r\n        value === null ? query.delete(key) : query.set(key, value);\r\n        \r\n        const url = window.location.href.replace(\r\n            window.location.search,\r\n            \"?\" + query.toString()\r\n        );\r\n\r\n        window.history[pushHistory ? \"pushState\" : \"replaceState\"]({ }, null, url);\r\n        window.dispatchEvent(new Event(\"popstate\"));\r\n    }\r\n}","import React from \"react\";\r\nimport \"./LinkWrapper.scss\";\r\n\r\nexport default class extends React.Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<a className=\"LinkWrapper\" {...this.props}>\r\n\t\t\t\t{ this.props.children }\r\n\t\t\t</a>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport \"./Posts.scss\";\r\nimport API from \"../../Classes/API\";\r\nimport { joinClassNames } from \"../../Classes/Constants\";\r\nimport InlineLoading from \"../InlineLoading\";\r\nimport Post from \"./Post\";\r\nimport { useEventListener } from \"../../Classes/Hooks\";\r\nimport QueryManager from \"../../Classes/QueryManager\";\r\nimport * as Feather from \"react-feather\";\r\nimport App from \"../../App\";\r\nimport _ from \"lodash\";\r\n\r\nlet lastPageChange = Date.now();\r\nlet hasReachedEnd = false;\r\nexport default function Posts({ search: additionalTags, emptyPlaceholder = null, request = null }) {\r\n    const [posts, setPosts] = React.useState([]);\r\n    const [isFetching, setFetchingState] = React.useState(true);\r\n    const [search, setSearchQuery] = React.useState(\"\");\r\n    const [hash, setHash] = React.useState(window.location.hash);\r\n    const [cachedRequest, setCachedRequest] = React.useState(request);\r\n    \r\n    Posts.instance = {\r\n        posts, setPosts,\r\n        isFetching, setFetchingState\r\n    };\r\n    \r\n    React.useEffect(() => {\r\n        const query = new URLSearchParams(window.location.search);\r\n        const page = parseInt(query.get(\"page\") || 1);\r\n        const tags = [\r\n            document.getElementById(\"searchField\")?.value,\r\n            additionalTags,\r\n            ...(App.userData?.blacklist ?? []).map(tag => `-${tag}`)\r\n        ].join(\" \");\r\n        \r\n        if (cachedRequest !== request) {\r\n            setFetchingState(true);\r\n            setCachedRequest(request);\r\n        }\r\n        \r\n        isFetching && setImmediate(() => {\r\n            if (request && !request[1].page)\r\n                request[1].page = page;\r\n            if (request && !request[1].tags)\r\n                request[1].tags = tags;\r\n            \r\n            let endpoint = \"posts\";\r\n            const params = { tags, page };\r\n            \r\n            if (additionalTags === `favoritedby:${App.e621User?.name}` &&\r\n                !document.getElementById(\"searchField\")?.value) {\r\n                endpoint = \"favorites\";\r\n                \r\n                delete params.tags;\r\n            }\r\n            \r\n            const _request = request ?? [\r\n                endpoint,\r\n                params\r\n            ];\r\n            \r\n            if (_.isEqual(Posts.lastSuccessfulRequest, _request) && Posts.lastHash === window.location.hash)\r\n                return setFetchingState(false);\r\n            \r\n            API.request(..._request).then(data => {\r\n                // This entire function should be abolished.\r\n                \r\n                setFetchingState(false);\r\n                \r\n                hasReachedEnd = false;\r\n                \r\n                if (page > 1 && !data.posts.length) {\r\n                    QueryManager.set(\"page\", page - 1, {\r\n                        pushHistory: false\r\n                    });\r\n                    \r\n                    hasReachedEnd = true;\r\n                }\r\n                else Posts.lastSuccessfulRequest = _request;\r\n                \r\n                const _posts =\r\n                    tags === search &&  window.location.hash === hash && !request\r\n                        ? [...posts, ...data.posts]\r\n                        : data.posts;\r\n                \r\n                setPosts(\r\n                    _posts.filter(\r\n                        (post, index) =>\r\n                            _posts.findIndex(p => p && p.id === post.id) === index\r\n                    )\r\n                );\r\n                \r\n                setSearchQuery(tags);\r\n                setHash(window.location.hash);\r\n            });\r\n        });\r\n    }, [isFetching, request]);\r\n    \r\n    // Handle infinite scrolling.\r\n    useEventListener(\"scroll\", () => {\r\n        if (Date.now() - lastPageChange < 2000 || isFetching || !posts?.length || hasReachedEnd) return;\r\n        \r\n        const target = document.documentElement;\r\n        \r\n        if (target.scrollTop >= target.scrollHeight - window.innerHeight - 100) {\r\n            QueryManager.set(\"page\", parseInt(QueryManager.get(\"page\", 1)) + 1, {\r\n                pushHistory: false\r\n            });\r\n            \r\n            lastPageChange = Date.now();\r\n        }\r\n    }, { dependencies: [isFetching, posts, request, hasReachedEnd] });\r\n    \r\n    return (\r\n        <div className=\"Posts\">\r\n            <h2 className=\"PageLabel\">{App.hash}</h2>\r\n            \r\n            { !isFetching && !posts?.length && (\r\n                <div className=\"NoPosts\">\r\n                    <div className=\"Placeholder\">{emptyPlaceholder ?? (\r\n                        <>\r\n                            <h2>No posts found.</h2>\r\n                            \r\n                            <div>\r\n                                Check your search tags, and ensure you've made no typos.\r\n                            </div>\r\n                        </>\r\n                    )}</div>\r\n                    \r\n                    <Feather.Frown/>\r\n                </div>\r\n            ) }\r\n            \r\n            <div className=\"Items\">\r\n                { posts?.map(post => <Post post={post} key={post.id}/>) }\r\n            </div>\r\n            \r\n            { hasReachedEnd && (\r\n                <div className=\"ReachedEndPlaceholder FlexCenter\">\r\n                    <h2>You've reached the end of your search.</h2>\r\n                    \r\n                    <Feather.Frown/>\r\n                </div>\r\n            ) }\r\n            \r\n            <div className={joinClassNames(\"FetchingStateModal\", [isFetching, \"Active\"])}>\r\n                <InlineLoading/>\r\n            </div>\r\n        </div>\r\n    );\r\n}","import React from \"react\";\r\nimport \"./InlineLoading.scss\";\r\n\r\nexport default function InlineLoading() {\r\n    return (\r\n        <div className=\"InlineLoadingContainer\">\r\n            <div className=\"Dot A\"/>\r\n            <div className=\"Dot B\"/>\r\n            <div className=\"Dot C\"/>\r\n        </div>\r\n    )\r\n}","import React from \"react\";\r\nimport App from \"../App\";\r\n\r\n/**\r\n * A setInterval hook for React components.\r\n * @param callback The function to call for the interval.\r\n * @param delay The delay between each call.\r\n * @param callInstantly Whether or not the callback will call instantly upon registering the hook.\r\n * @param deps The dependencies array for the hook.\r\n */\r\nexport function useInterval(callback, delay, callInstantly = false, deps = []) {\r\n    // Create side effect\r\n    React.useEffect(() => {\r\n        // Create interval based on delay\r\n        const interval = setInterval(callback, delay);\r\n        // If call instantly is truthy, run the callback\r\n        callInstantly && callback();\r\n\r\n        // On unmount, clear the interval\r\n        return () => clearInterval(interval);\r\n    }, deps);\r\n}\r\n\r\nexport function useMounted() {\r\n    const state = React.createRef(false);\r\n\r\n    React.useEffect(() => {\r\n        state.current = true;\r\n\r\n        return () => state.current = false;\r\n    }, []);\r\n\r\n    return state;\r\n}\r\n\r\nconst promiseCache = {};\r\nexport function usePromise(promise, useCache = true, deps = []) {\r\n    const [value, setValue] = React.useState(useCache ? promiseCache[promise] : null);\r\n    const isMounted = useMounted();\r\n\r\n    React.useEffect(() => {\r\n        !value && promise().then(v => (isMounted.current && setValue(v), promiseCache[promise] = v));\r\n    }, deps);\r\n\r\n    return value;\r\n}\r\n\r\nexport function useEventListener(eventType, callback, options = {}) {\r\n    const {\r\n        target = document,\r\n        dependencies = [],\r\n        init = false\r\n    } = options;\r\n\r\n    React.useEffect(() => {\r\n        target.addEventListener(eventType, callback);\r\n        init && callback();\r\n\r\n        return () => target.removeEventListener(eventType, callback);\r\n    }, dependencies);\r\n}\r\n\r\nexport function useOnMount(callback) {\r\n    React.useEffect(() => {\r\n        callback();\r\n    }, []);\r\n}\r\n\r\nexport function useOnUnmount(callback) {\r\n    React.useEffect(() => {\r\n        return callback;\r\n    }, []);\r\n}\r\n\r\n// Sucralose-specific hooks\r\n\r\n","import { initializeApp } from \"firebase/app\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { getFirestore, doc, getDoc, setDoc, updateDoc } from \"firebase/firestore\";\r\n\r\nconst config = {\r\n    apiKey: \"AIzaSyDmojC5Kl5vtST4vIyW81UfCrR6B18HnKw\",\r\n    authDomain: \"sucralose-74a13.firebaseapp.com\",\r\n    projectId: \"sucralose-74a13\",\r\n    storageBucket: \"sucralose-74a13.appspot.com\",\r\n    messagingSenderId: \"43887129209\",\r\n    appId: \"1:43887129209:web:7d607e00a979144af85aa8\"\r\n};\r\n\r\n// Long story short, I fucking hate the new Firebase API. (V9)\r\n// This is my attempt at at least making it tolerable.\r\nexport default new class Database {\r\n    app = initializeApp(config);\r\n    auth = getAuth();\r\n    db = getFirestore();\r\n    \r\n    async get(...path) {\r\n        const ref = doc(this.db, ...path);\r\n        const snapshot = await getDoc(ref);\r\n        if (!snapshot.exists()) return null;\r\n        \r\n        return {\r\n            _ref: ref,\r\n            _snapshot: snapshot,\r\n            id: snapshot.id,\r\n            ...snapshot.data()\r\n        };\r\n    }\r\n    \r\n    serializeObject(obj) {\r\n        const _new = { ...obj };\r\n        \r\n        delete _new._ref;\r\n        delete _new._snapshot;\r\n        delete _new.id;\r\n        \r\n        return _new;\r\n    }\r\n    \r\n    async set(data, ...path) {\r\n        return await setDoc(doc(this.db, ...path), this.serializeObject(data))\r\n            .catch(e => console.error(`Error setting doc data at \"${path.join(\"/\")}\"\\n${e.stack}`));\r\n    }\r\n    \r\n    async update(data, ...path) {\r\n        // TODO writing on error is very unsafe. Don't do that.\r\n        return await updateDoc(doc(this.db, ...path), this.serializeObject(data))\r\n            .catch(() => this.set(data, ...path))\r\n            .catch(e => console.error(`Error updating doc data at \"${path.join(\"/\")}\"\\n${e.stack}`));\r\n    }\r\n}","export default __webpack_public_path__ + \"static/media/0.e687b5f9.png\";","export default __webpack_public_path__ + \"static/media/1.cde179fe.png\";","export default __webpack_public_path__ + \"static/media/2.c54309b2.png\";","import React from \"react\";\r\nimport \"./SettingsPage.scss\";\r\nimport Header from \"../Components/General/Header\";\r\nimport { Modals } from \"../Components/Modals\";\r\nimport TutorialModal from \"../Components/Modals/TutorialModal\";\r\nimport Toasts from \"../Components/Toasts\";\r\nimport Database from \"../Classes/Database\";\r\nimport App from \"../App\";\r\nimport _ from \"lodash\";\r\nimport * as Feather from \"react-feather\";\r\n\r\nimport ApiKeyHelp0 from \"../Help/API Key/0.png\";\r\nimport ApiKeyHelp1 from \"../Help/API Key/1.png\";\r\nimport ApiKeyHelp2 from \"../Help/API Key/2.png\";\r\nimport Tooltip from \"../Components/Tooltip\";\r\nimport { getRandomKey } from \"../Classes/Constants\";\r\n\r\nfunction ApiKeyTutorialModal() {\r\n\treturn (\r\n\t\t<TutorialModal>\r\n\t\t\t<h3>\r\n\t\t\t\tYour API key is <b style={{ color: \"var(--red)\" }}>NOT</b> your pasword.\r\n\t\t\t</h3>\r\n\r\n\t\t\t<h4>\r\n\t\t\t\tIt is used to interface with the e621 API, safely and securely;\r\n\t\t\t</h4>\r\n\r\n\t\t\t<h4>\r\n\t\t\t\thowever, you should refrain from revealing this API key to anyone,\r\n\t\t\t\tas it gives them access to all of your content, and the ability to post and vote as you.\r\n\t\t\t</h4>\r\n\r\n\t\t\t<h4>\r\n\t\t\t\tIf you do not trust Sucralose, all of the source is available on GitHub,\r\n\t\t\t\tI recommend and encourage you to view and analyze the source code.\r\n\t\t\t</h4>\r\n\r\n\t\t\t<p>\r\n\t\t\t\tThat being said, you may gain access to your API key by navigating\r\n\t\t\t\tto <a href=\"https://e621.net/users/home\">https://e621.net/users/home</a> and\r\n\t\t\t\tfollowing the steps below.\r\n\t\t\t</p>\r\n\r\n\t\t\t<p style={{ marginTop: 50 }}>\r\n\t\t\t\t<h2>Step 1</h2>\r\n\t\t\t\tAfter navigating to your home page (and signing in if necessary),\r\n\t\t\t\tyou'll want to navigate to <b>Manage API Access</b>.\r\n\t\t\t</p>\r\n\t\t\t<img src={ApiKeyHelp0} alt=\"Help\" />\r\n\r\n\t\t\t<p style={{ marginTop: 50 }}>\r\n\t\t\t\t<h2>Step 2</h2>\r\n\t\t\t\tEnter your password, and press <b>Submit</b>.\r\n\t\t\t</p>\r\n\t\t\t<img src={ApiKeyHelp1} alt=\"Help\" />\r\n\r\n\t\t\t<p style={{ marginTop: 50 }}>\r\n\t\t\t\t<h2>Step 3</h2>\r\n\t\t\t\tCopy the text under <b>API Key</b> to your clipboard.\r\n\t\t\t</p>\r\n\t\t\t<img src={ApiKeyHelp2} alt=\"Help\" />\r\n\r\n\t\t\t<p style={{ marginTop: 50 }}>\r\n\t\t\t\t<h2>Step 4, Final</h2>\r\n\t\t\t\tNow that you have the API key, simple enter your username and API key\r\n\t\t\t\tinto their respective fields in Sucralose.\r\n\t\t\t</p>\r\n\t\t</TutorialModal>\r\n\t)\r\n}\r\n\r\nfunction ApiKeySection() {\r\n\tconst events = {\r\n\t\tsaveUsername: ({ target }) => {\r\n\t\t\tif (target.value.trim() === App.userData?.username) return;\r\n\r\n\t\t\tif (target.length > 36)\r\n\t\t\t\treturn Toasts.showToast(\"Username is too long\", \"Failure\");\r\n\r\n\t\t\tDatabase.update({ username: target.value }, \"users\", App.user.uid)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tToasts.showToast(\"Username updated\", \"Success\");\r\n\r\n\t\t\t\t\t_.merge(App.userData, { username: target.value });\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tsaveApiKey: ({ target }) => {\r\n\t\t\tif (target.value.trim() === App.userData?.apiKey) return;\r\n\r\n\t\t\tif (target.length > 36)\r\n\t\t\t\treturn Toasts.showToast(\"Invalid API key\", \"Failure\");\r\n\r\n\t\t\tDatabase.update({ apiKey: target.value }, \"users\", App.user.uid)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tToasts.showToast(\"API key updated\", \"Success\");\r\n\r\n\t\t\t\t\t_.merge(App.userData, { apiKey: target.value });\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\treturn App.user && App.userReady ? (\r\n\t\t<div className=\"Section ApiKey\">\r\n\t\t\t<h1>E621 API Key</h1>\r\n\r\n\t\t\t<u onClick={() => Modals.push(<ApiKeyTutorialModal />)}>\r\n\t\t\t\tWhat's this?\r\n\t\t\t</u>\r\n\r\n\t\t\t<div className=\"FieldContainer\">\r\n\t\t\t\t<input className=\"Field\" placeholder=\"Username\"\r\n\t\t\t\t\tdefaultValue={App.userData.username}\r\n\t\t\t\t\tonBlur={events.saveUsername} />\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"FieldContainer\">\r\n\t\t\t\t<input className=\"Field Confidential\" placeholder=\"API Key\"\r\n\t\t\t\t\tdefaultValue={App.userData.apiKey}\r\n\t\t\t\t\tonBlur={events.saveApiKey} />\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t) : null;\r\n}\r\n\r\nexport default function SettingsPage() {\r\n\tconst updateDeBouncer = _.debounce(() => SettingsRenderer.forceUpdate(), 200);\r\n\tconst saveDeBouncer = _.debounce(Settings.save.bind(Settings), 2000);\r\n\r\n\tconst [, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n\tSettingsPage.forceUpdate = forceUpdate;\r\n\r\n\treturn (\r\n\t\t<div className=\"SettingsPage\">\r\n\t\t\t<Header hasSearch={false} />\r\n\r\n\t\t\t<div className=\"Section\">\r\n\t\t\t\t<div className=\"Button\" onClick={() => Database.auth.signOut().then(() => (window.location.hash = \"\", window.location.reload()))}>\r\n\t\t\t\t\tSign Out\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<ApiKeySection />\r\n\r\n\t\t\t{Object.entries(Settings.props).map(([categoryName, props]) => (\r\n\t\t\t\t<div className=\"Section\" key={categoryName}>\r\n\t\t\t\t\t<h1>{formatCamelCase(categoryName)}</h1>\r\n\r\n\t\t\t\t\t{Object.entries(props).map(([name, setting]) => (\r\n\t\t\t\t\t\t<SettingField\r\n\t\t\t\t\t\t\tkey={getRandomKey()}\r\n\t\t\t\t\t\t\tname={name}\r\n\t\t\t\t\t\t\tsetting={setting}\r\n\t\t\t\t\t\t\tresetValue={Settings.defaults[categoryName][name].value}\r\n\t\t\t\t\t\t\tcallback={value =>\r\n\t\t\t\t\t\t\t\t(Settings.props[categoryName][name].value = value, saveDeBouncer(), updateDeBouncer())}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport const Settings = new class Settings {\r\n\tdefaults = {\r\n\t\taccentColors: {\r\n\t\t\tprimary: {\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tvalue: \"#7bb1bd\"\r\n\t\t\t},\r\n\t\t\tsecondary: {\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tvalue: \"#BD7BA2\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tbackgroundColors: {\r\n\t\t\tprimary: {\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tvalue: \"#2c3946\"\r\n\t\t\t},\r\n\t\t\tsecondary: {\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tvalue: \"#364758\"\r\n\t\t\t},\r\n\t\t\ttertiary: {\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tvalue: \"#364758\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tbackgroundImage: {\r\n\t\t\turl: {\r\n\t\t\t\ttype: \"string\",\r\n\t\t\t\tvalue: \"\",\r\n\t\t\t\tplaceholder: \"Example - https://c.tenor.com/Z6gmDPeM6dgAAAAC/dance-moves.gif\"\r\n\t\t\t},\r\n\t\t\tbrightness: {\r\n\t\t\t\ttype: \"slider\",\r\n\t\t\t\tmin: 0, max: 100,\r\n\t\t\t\tstep: 1,\r\n\t\t\t\tvalue: 100\r\n\t\t\t},\r\n\t\t\tblur: {\r\n\t\t\t\ttype: \"slider\",\r\n\t\t\t\tmin: 0, max: 25,\r\n\t\t\t\tstep: 0.5,\r\n\t\t\t\tvalue: 0\r\n\t\t\t},\r\n\t\t\tpositionX: {\r\n\t\t\t\ttype: \"slider\",\r\n\t\t\t\tmin: 0, max: 100,\r\n\t\t\t\tstep: 1,\r\n\t\t\t\tvalue: 50\r\n\t\t\t},\r\n\t\t\tpositionY: {\r\n\t\t\t\ttype: \"slider\",\r\n\t\t\t\tmin: 0, max: 100,\r\n\t\t\t\tstep: 1,\r\n\t\t\t\tvalue: 50\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tprops = _.merge({}, this.defaults);\r\n\r\n\tasync save() {\r\n\t\t_.merge(App.userData?.settings, this.props);\r\n\r\n\t\tawait Database.update(App.userData, \"users\", App.user.uid)\r\n\t\t\t.then(() => Toasts.showToast(\"Settings updated on the database\"))\r\n\t\t\t.catch(err => (console.error(err), Toasts.showToast(\"An unknown error occurred while saving settings\", \"Failure\")));\r\n\t}\r\n}\r\n\r\nfunction formatCamelCase(camelCase) {\r\n\tconst r = camelCase.replace(/([A-Z])/g, \" $1\");\r\n\r\n\treturn r.charAt(0).toUpperCase() + r.slice(1);\r\n}\r\n\r\nexport function SettingField({ name, setting, resetValue, callback }) {\r\n\tconst [value, setValueState] = React.useState(setting.value);\r\n\tconst pickerRef = React.useRef();\r\n\tconst inputRef = React.useRef();\r\n\tconst setState = newVal => {\r\n\t\tcallback?.(newVal);\r\n\t\tsetValueState(newVal);\r\n\r\n\t\tif (pickerRef.current) pickerRef.current.value = newVal;\r\n\t\tif (inputRef.current) inputRef.current.value = newVal;\r\n\t};\r\n\r\n\tconst resetButton = value !== resetValue && (\r\n\t\t<div className=\"ResetButton\"\r\n\t\t\tonClick={() => setState(resetValue)}>\r\n\t\t\t<Feather.RotateCcw />\r\n\r\n\t\t\t<Tooltip>Reset To Default</Tooltip>\r\n\t\t</div>\r\n\t);\r\n\r\n\tswitch (setting.type) {\r\n\t\tdefault: return null;\r\n\r\n\t\tcase \"color\": return (\r\n\t\t\t<div className=\"FieldContainer\">\r\n\t\t\t\t<h4 className=\"FieldTitle\">{formatCamelCase(name)}</h4>\r\n\r\n\t\t\t\t<div className=\"Flex\" style={{ alignItems: \"center\" }}>\r\n\t\t\t\t\t<input className=\"ColorPicker\" defaultValue={value}\r\n\t\t\t\t\t\ttype=\"color\"\r\n\t\t\t\t\t\tref={pickerRef}\r\n\t\t\t\t\t\tonInput={e => setState(e.currentTarget.value)} />\r\n\r\n\t\t\t\t\t<input className=\"Field ColorField\" defaultValue={value}\r\n\t\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\t\tstyle={{ borderColor: value }}\r\n\t\t\t\t\t\tmaxLength={64}\r\n\t\t\t\t\t\tonInput={e => setState(e.currentTarget.value)} />\r\n\r\n\t\t\t\t\t{resetButton}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\r\n\t\tcase \"string\": return (\r\n\t\t\t<div className=\"FieldContainer\">\r\n\t\t\t\t<h4 className=\"FieldTitle\">{formatCamelCase(name)}</h4>\r\n\r\n\t\t\t\t<div className=\"Flex\" style={{ alignItems: \"center\" }}>\r\n\t\t\t\t\t<input className=\"Field\" defaultValue={value}\r\n\t\t\t\t\t\tplaceholder={setting.placeholder}\r\n\t\t\t\t\t\tref={inputRef} maxLength={128}\r\n\t\t\t\t\t\tonInput={e => setState(e.currentTarget.value)} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\r\n\t\tcase \"slider\": return (\r\n\t\t\t<div className=\"FieldContainer\">\r\n\t\t\t\t<h4 className=\"FieldTitle\">{formatCamelCase(name)} - {value}</h4>\r\n\r\n\t\t\t\t<div className=\"Flex\" style={{ alignItems: \"center\" }}>\r\n\t\t\t\t\t<input className=\"Field ColorField\" defaultValue={value}\r\n\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\t\tonInput={e => setState(e.currentTarget.value)}\r\n\t\t\t\t\t\tmin={setting.min} max={setting.max} />\r\n\r\n\t\t\t\t\t{resetButton}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport function SettingsRenderer() {\r\n\tconst [, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n\tSettingsRenderer.forceUpdate = forceUpdate;\r\n\r\n\tconst { props } = Settings;\r\n\r\n\treturn (\r\n\t\t<style>\r\n\t\t\t{`\r\n            \r\n\t\t\t:root {\r\n\t\t\t\t--primary-color: ${props.accentColors.primary.value};\r\n\t\t\t\t--secondary-color: ${props.accentColors.secondary.value};\r\n\t\t\t\t\r\n\t\t\t\t--primary-bg: ${props.backgroundColors.primary.value};\r\n\t\t\t\t--secondary-bg: ${props.backgroundColors.secondary.value};\r\n\t\t\t\t--tertiary-bg: ${props.backgroundColors.tertiary.value};\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t`}\r\n\r\n\t\t\t{!!props.backgroundImage?.url?.value?.trim?.() && `\r\n                .AppBackground {\r\n                    background-image: url(\"${props.backgroundImage.url.value}\");\r\n                    background-position: ${props.backgroundImage.positionX.value}%\r\n                                         ${props.backgroundImage.positionY.value}%;\r\n                    \r\n                    filter: blur(${props.backgroundImage.blur.value || 0}px)\r\n                            brightness(${props.backgroundImage.brightness.value}%);\r\n                            \r\n                    opacity: 1;\r\n                }\r\n                \r\n                footer {\r\n                    backdrop-filter: blur(7px);\r\n                }\r\n                \r\n                .SearchFieldContainer.Focused:After {\r\n                    background-color: rgba(0,0,0, 0.2);\r\n                    backdrop-filter: blur(5px);\r\n                }\r\n            ` }\r\n\t\t</style>\r\n\t);\r\n}","import React from \"react\";\r\nimport \"./Header.scss\";\r\nimport SearchField from \"./SearchField\";\r\nimport { NavigationButtonsComponent } from \"../../Pages/Home\";\r\n\r\nexport default function Header({\r\n    searchPlaceholder = null,\r\n    hasSearch = true\r\n}) {\r\n    return (\r\n        <div className=\"Header\">\r\n            <div>\r\n                { hasSearch && <SearchField placeholder={searchPlaceholder}/> }\r\n                \r\n                <NavigationButtonsComponent className=\"NavigationButtons\"\r\n                                            tooltipMode/>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React from \"react\";\r\nimport \"./SearchField.scss\";\r\nimport * as Feather from \"react-feather\";\r\nimport { joinClassNames } from \"../../Classes/Constants\";\r\nimport _ from \"lodash\";\r\nimport API from \"../../Classes/API\";\r\nimport InlineLoading from \"../InlineLoading\";\r\nimport Tooltip from \"../Tooltip\";\r\nimport Posts from \"../Posts/Posts\";\r\nimport SetsList from \"../../Pages/SetsPage\";\r\n\r\n// Create the tag icon types.\r\nexport const TagTypes = {\r\n\t0: { icon: <Feather.Hash />, tooltip: \"General\" },\r\n\t1: { icon: <Feather.Edit2 />, tooltip: \"Artist\" },\r\n\t3: { icon: <Feather.Award />, tooltip: \"Copyright\" },\r\n\t4: { icon: <Feather.User />, tooltip: \"Character\" },\r\n\t5: { icon: <Feather.Activity />, tooltip: \"Species\" },\r\n\t6: { icon: <Feather.AlertTriangle />, tooltip: \"Invalid\" },\r\n\t7: { icon: <Feather.AlignCenter />, tooltip: \"Meta\" },\r\n\t8: { icon: <Feather.BookOpen />, tooltip: \"Lore\" }\r\n};\r\n\r\nexport default function SearchField({\r\n\tplaceholder = \"Search...\"\r\n}) {\r\n\tconst [focused, setFocused] = React.useState(false);\r\n\tconst [autoCompleteEntries, setAutoCompleteEntries] = React.useState([]);\r\n\tconst ref = React.useRef();\r\n\r\n\tconst defaultValue = new URLSearchParams(window.location.search).get(\"search\");\r\n\tSearchField.value = defaultValue;\r\n\r\n\tfunction search(value = null) {\r\n\t\t// If a value was passed, set the value to that.\r\n\t\tif (value) ref.current.value = value;\r\n\r\n\t\tPosts.lastSuccessfulRequest = null;\r\n\r\n\t\t// Get the query params as an object.\r\n\t\tconst params = new URLSearchParams(window.location.search);\r\n\t\t// Set the search value of the query params.\r\n\t\tparams.set(\"search\", ref.current.value);\r\n\t\t// Clear the page from the params.\r\n\t\tparams.delete(\"page\");\r\n\r\n\t\twindow.history.pushState(\r\n\t\t\t{},\r\n\t\t\tnull,\r\n\t\t\t`?${params.toString()}${window.location.hash || \"#posts\"}`\r\n\t\t);\r\n\r\n\t\tPosts.instance?.setPosts([]);\r\n\t\tSetsList.instances?.forEach(instance => instance.setSets([]));\r\n\t\twindow.dispatchEvent(new Event(\"popstate\"));\r\n\t}\r\n\r\n\tSearchField.handleSearch = search;\r\n\r\n\t// Create the events object.\r\n\tconst events = React.useMemo(() => ({\r\n\t\tonFocus: () => setFocused(true),\r\n\t\tonBlur: () => setFocused(false),\r\n\t\tonKeyDown: e => e.key === \"Enter\" && search(),\r\n\t\tonInput: _.debounce(async e => {\r\n\t\t\t// Get the text content of the input.\r\n\t\t\tconst { value } = e.target;\r\n\t\t\tSearchField.value = value;\r\n\r\n\t\t\t// Get the search string.\r\n\t\t\tconst search = value.split(/\\s/).slice(-1)[0].replace(/[-~*]/g, \"\");\r\n\t\t\t// If the search string is empty, clear the state and return.\r\n\t\t\tif (!search.trim()) return setAutoCompleteEntries([]);\r\n\r\n\t\t\t// Display a loading indicator.\r\n\t\t\tsetAutoCompleteEntries([null]);\r\n\r\n\t\t\t// Fetch the auto complete entries from the api.\r\n\t\t\tconst entries = await API.request(\"tags/autocomplete\", {\r\n\t\t\t\t\"search[name_matches]\": search\r\n\t\t\t});\r\n\r\n\t\t\t// Set the auto complete entries.\r\n\t\t\tsetAutoCompleteEntries(entries?.tags ?? entries);\r\n\t\t}, 200)\r\n\t}), []);\r\n\r\n\t// Create auto complete entry click handler.\r\n\tfunction handleAutoCompleteEntryClick(tag) {\r\n\t\t// Get all tag entries\r\n\t\tconst tags = ref.current.value.split(/\\s/);\r\n\t\t// Set the input text to the clicked tag name.\r\n\t\tref.current.value = [\r\n\t\t\t// Get the text content of the input, excluding the last word.\r\n\t\t\t...tags.slice(0, -1),\r\n\t\t\t// Append the tag name to the list of tags.\r\n\t\t\t(tags[tags.length - 1].match(/[^a-z0-9]/gi)?.[0] ?? \"\") + tag.name,\r\n\t\t\t// And a little spacey.\r\n\t\t\t\"\"\r\n\t\t].join(\" \");\r\n\r\n\t\t// Clear the auto complete entries.\r\n\t\tsetAutoCompleteEntries([]);\r\n\r\n\t\t// Wait for the next frame because JavaScript is shitting through the screen.\r\n\t\tsetImmediate(() => {\r\n\t\t\t// Set the selection index to the end of the list.\r\n\t\t\tref.current.selectionStart =\r\n\t\t\t\tref.current.selectionEnd = ref.current.value.length;\r\n\r\n\t\t\t// Focus the input field element.\r\n\t\t\tref.current.focus();\r\n\t\t});\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className={joinClassNames(\"SearchFieldContainer\", [focused, \"Focused\"])}>\r\n\t\t\t<input className=\"SearchField\" {...events} ref={ref}\r\n\t\t\t\tid=\"searchField\" autoCorrect=\"false\"\r\n\t\t\t\tdefaultValue={defaultValue}\r\n\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\tplaceholder={placeholder} />\r\n\r\n\t\t\t<Feather.Search className=\"Button\" onClick={search.bind(null, null)} />\r\n\r\n\t\t\t<div className=\"AutoCompleteContainer\">\r\n\t\t\t\t{autoCompleteEntries.map(tag => tag === null\r\n\t\t\t\t\t? (\r\n\t\t\t\t\t\t<div className=\"AutoCompleteEntry\" style={{ padding: 10 }}>\r\n\t\t\t\t\t\t\t<InlineLoading key={Date.now().toString(36)} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\ttag.categoryIcon = TagTypes[tag.category] ?? TagTypes[\"0\"],\r\n\t\t\t\t\t\t<div className=\"AutoCompleteEntry\" key={tag.id}\r\n\t\t\t\t\t\t\tonMouseDown={handleAutoCompleteEntryClick.bind(this, tag)}>\r\n\t\t\t\t\t\t\t<div className=\"IconContainer\">\r\n\t\t\t\t\t\t\t\t{tag.categoryIcon.icon}\r\n\r\n\t\t\t\t\t\t\t\t<Tooltip>{tag.categoryIcon.tooltip}</Tooltip>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{tag.antecedent_name ? (\r\n\t\t\t\t\t\t\t\t<div className=\"Title\">\r\n\t\t\t\t\t\t\t\t\t{tag.name} <span style={{ opacity: 0.75 }}>({tag.antecedent_name})</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) : <span className=\"Title\">{tag.name}</span>}\r\n\t\t\t\t\t\t\t<span className=\"PostCount\">{tag.post_count} posts</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}","import React from \"react\";\r\nimport \"./ErrorBoundary.scss\";\r\nimport { closeModal, openModal } from \"./Modals\";\r\n\r\nexport default class ErrorBoundary extends React.Component {\r\n    state = { error: null, errorInfo: null, moreInfo: false };\r\n    \r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n    \r\n    componentDidCatch(error, errorInfo) {\r\n        // console.error(error, errorInfo);\r\n        \r\n        this.setState({ error, errorInfo });\r\n    }\r\n    \r\n    showErrorInfo() {\r\n        const { error, errorInfo } = this.state;\r\n        \r\n        openModal(\r\n            <div className=\"ErrorInfoModal PrimaryBg\" onClick={() => closeModal()}>\r\n                <h1>{error.message}</h1>\r\n                { errorInfo.componentStack.split(\"\\n\").slice(0, 10).map((msg, i) => <h2 key={i}>{msg}</h2>) }\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    renderError() {\r\n        const { moreInfo } = this.state;\r\n        \r\n        return (\r\n            <div className=\"ErrorBoundaryHandler\">\r\n                <h1>There was an error with this component!</h1>\r\n                <h2>This is due to a plugin error or application error.</h2>\r\n                \r\n                <div className=\"ErrorBoundaryFooter\">\r\n                    <div className=\"ErrorBoundaryButton TertiaryBg\" onClick={() => this.showErrorInfo()}>More Info</div>\r\n                    <div className=\"ErrorBoundaryButton BackgroundDanger\" onClick={() => this.setState({ error: null })}>Retry</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    render() {\r\n        if (this.state.error)\r\n            return this.renderError();\r\n        \r\n        return this.props.children;\r\n    }\r\n}","import React from \"react\";\r\nimport \"./TutorialModal.scss\";\r\nimport * as Feather from \"react-feather\";\r\nimport { Modals } from \"../Modals\";\r\n\r\nexport default function TutorialModal({ children, title = \"Help\" }) {\r\n    return (\r\n        <div className=\"TutorialModal\">\r\n            <div className=\"ModalHeader\">\r\n                <h2>{title}</h2>\r\n                \r\n                <Feather.X onClick={Modals.pop.bind(Modals)}/>\r\n            </div>\r\n            \r\n            <div className=\"ModalBody\">\r\n                { children }\r\n            </div>\r\n        </div>\r\n    );\r\n}","import React from \"react\";\r\nimport \"./SetsPage.scss\";\r\nimport API from \"../Classes/API\";\r\nimport QueryManager from \"../Classes/QueryManager\";\r\nimport { useEventListener } from \"../Classes/Hooks\";\r\nimport Header from \"../Components/General/Header\";\r\nimport * as Feather from \"react-feather\";\r\nimport { joinClassNames } from \"../Classes/Constants\";\r\nimport InlineLoading from \"../Components/InlineLoading\";\r\nimport LinkWrapper from \"../Components/LinkWrapper\";\r\nimport TabsList from \"../Components/TabsList\";\r\nimport App from \"../App\";\r\n\r\nlet lastPageChange = Date.now();\r\nexport default function SetsList({ options = { } }) {\r\n    const [sets, setSets] = React.useState([]);\r\n    const [isFetching, setFetchingState] = React.useState(true);\r\n    const [search, setSearchQuery] = React.useState(\"\");\r\n    const [hash, setHash] = React.useState(window.location.hash);\r\n    \r\n    React.useEffect(() => {\r\n        if (!SetsList.instances) SetsList.instances = [];\r\n        \r\n        const instanceIndex = SetsList.instances.push({\r\n            sets, setSets,\r\n            isFetching, setFetchingState\r\n        });\r\n        \r\n        const page = QueryManager.get(\"page\") || 1;\r\n        const query = document.getElementById(\"searchField\").value;\r\n        \r\n        API.request(\r\n            \"post_sets\",\r\n            {\r\n                commit: \"Search\", page,\r\n                \"search[order]\": \"update\",\r\n                \"search[name]\": `*${query}*`,\r\n                ...options\r\n            }\r\n        ).then(newSets => {\r\n            setFetchingState(false);\r\n            if (!Array.isArray(newSets)) return;\r\n            \r\n            const _sets =\r\n                query === search && window.location.hash === hash\r\n                    ? [...sets, ...newSets]\r\n                    : newSets;\r\n            \r\n            setSets(\r\n                _sets.filter(\r\n                    (set, index) =>\r\n                        _sets.findIndex(s => s && s.id === set.id) === index\r\n                )\r\n            );\r\n            \r\n            setSearchQuery(query);\r\n            setHash(window.location.hash);\r\n        });\r\n        \r\n        return () => {\r\n            SetsList.instances.splice(instanceIndex, 1);\r\n        };\r\n    }, [isFetching]);\r\n\r\n    // Handle infinite scrolling.\r\n    useEventListener(\"scroll\", () => {\r\n        if (Date.now() - lastPageChange < 2000 || isFetching || !sets?.length) return;\r\n\r\n        const target = document.documentElement;\r\n\r\n        if (target.scrollTop >= target.scrollHeight - window.innerHeight - 100) {\r\n            QueryManager.set(\"page\", parseInt(QueryManager.get(\"page\", 1)) + 1, {\r\n                pushHistory: false\r\n            });\r\n\r\n            lastPageChange = Date.now();\r\n        }\r\n    }, { dependencies: [isFetching, sets] });\r\n    \r\n    return (\r\n        <div className=\"Sets\">\r\n            { !isFetching && !sets?.length && (\r\n                <div className=\"NoSets\">\r\n                    <div className=\"Placeholder\">\r\n                        <h2>No sets found.</h2>\r\n\r\n                        <div>\r\n                            Check your search tags, and ensure you've made no typos.\r\n                        </div>\r\n                    </div>\r\n\r\n                    <Feather.Frown/>\r\n                </div>\r\n            ) }\r\n            \r\n            <div className=\"Items\">\r\n                { sets?.map(set => (\r\n                    <LinkWrapper key={set.id} href={`?search=set:${set.shortname}#posts`}>\r\n                        <div className=\"PostSet\">\r\n                            <div className=\"Head\">\r\n                                <div className=\"Title\">{set.name}</div>\r\n\r\n                                <div className=\"ShortName\">\r\n                                    ID - {set.shortname} | {set.id}\r\n                                </div>\r\n                            </div>\r\n\r\n                            { set.description && <div className=\"Description\">{set.description}</div> }\r\n                        </div>\r\n                    </LinkWrapper>\r\n                )) }\r\n            </div>\r\n\r\n            <div className={joinClassNames(\"FetchingStateModal\", [isFetching, \"Active\"])}>\r\n                <InlineLoading/>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function SetsPage() {\r\n    return (\r\n        <div className=\"SetsPage\">\r\n            <Header searchPlaceholder=\"Search sets...\"/>\r\n            \r\n            <TabsList tabs={[\"All\", \"Owned\", \"Subscribed\"]}>\r\n                <SetsList/>\r\n                \r\n                <SetsList options={{\r\n                    \"search[creator_name]\": App.userData?.username \r\n                }}/>\r\n\r\n                <div className=\"NoSets\">\r\n                    <div className=\"Placeholder\">\r\n                        <h2>Not yet added.</h2>\r\n\r\n                        <div>\r\n                            This feature isn't yet available.\r\n                        </div>\r\n                        \r\n                        <div>\r\n                            However, you can navigate to <a href=\"#subscriptions\">#subscriptions</a> and search <b>set:*</b>\r\n                        </div>\r\n                        \r\n                        <div>\r\n                            This will display all subscribed set posts.\r\n                        </div>\r\n                    </div>\r\n\r\n                    <Feather.Frown/>\r\n                </div>\r\n            </TabsList>\r\n        </div>\r\n    )\r\n}","import React from \"react\";\r\nimport \"./PostsPage.scss\";\r\nimport Posts from \"../Components/Posts/Posts\";\r\nimport Header from \"../Components/General/Header\";\r\nimport App from \"../App\";\r\n\r\nexport default function PostsPage({ search, searchPlaceholder, emptyPlaceholder = null }) {\r\n    return (\r\n        <div className=\"PostsPage\">\r\n            <Header searchPlaceholder={searchPlaceholder}/>\r\n            \r\n            { App.userReady && <Posts search={search} emptyPlaceholder={emptyPlaceholder}/> }\r\n        </div>\r\n    )\r\n}","import React from \"react\";\r\nimport \"./Home.scss\";\r\nimport SearchField from \"../Components/General/SearchField\";\r\nimport * as Feather from \"react-feather\";\r\nimport LinkWrapper from \"../Components/LinkWrapper\";\r\nimport Tooltip from \"../Components/Tooltip\";\r\nimport { joinClassNames } from \"../Classes/Constants\";\r\nimport App from \"../App\";\r\nimport TutorialModal from \"../Components/Modals/TutorialModal\";\r\nimport { Modals } from \"../Components/Modals\";\r\n\r\nexport const NavigationButtons = {\r\n\tposts: { icon: <Feather.Grid/>, title: \"Latest Posts\" },\r\n\thot: { icon: <Feather.TrendingUp/>, title: \"Hot Posts\" },\r\n\tpopular: { icon: <Feather.BarChart2/>, title: \"Popular Posts\" },\r\n\tsets: { icon: <Feather.Layers/>, title: \"Browse Sets\" },\r\n\t\r\n\tsubscriptions: { icon: <Feather.Bell/>, title: \"Subscriptions\" },\r\n\tfavorites: { icon: <Feather.Heart/>, title: \"Favorites\" },\r\n\tupvoted: { icon: <Feather.ThumbsUp/>, title: \"Upvoted Posts\" },\r\n\tsettings: { icon: <Feather.Settings/>, title: \"Settings\" },\r\n};\r\n\r\nexport const newsPosts = [{\r\n\tdate: \"09/09/2021\",\r\n\ttitle: \"Welcome to the new Sucralose!\",\r\n\tmodal: function NewsPost090921() {\r\n\t\treturn (\r\n\t\t\t<TutorialModal title={this.title}>\r\n\t\t\t\t<h2>What's different?</h2>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tI've re-built the site from the ground up, with better code, performance,\r\n\t\t\t\t\tand most importantly, better device support.\r\n\t\t\t\t</p>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\tSome of the new features include the following:\r\n\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t<div><b>Database!</b></div>\r\n\t\t\t\t\t\t\tI've added a Firebase database to the site, which will let you create\r\n\t\t\t\t\t\t\tan account and sync your data between devices and browsers.\r\n\t\t\t\t\t\t</li>\r\n\r\n\t\t\t\t\t\t<br/>\r\n\r\n\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t<div><b>Mobile support</b></div>\r\n\t\t\t\t\t\t\tMobile support was pretty bad in the previous release, but\r\n\t\t\t\t\t\t\tthis version was started with mobile in mind.\r\n\t\t\t\t\t\t</li>\r\n\r\n\t\t\t\t\t\t<br/>\r\n\r\n\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t<div><b>Better UI/UX</b></div>\r\n\t\t\t\t\t\t\tThis is of course an opinional thing, but the user interface and user\r\n\t\t\t\t\t\t\texperience has been redesigned for a friendlier experience.\r\n\t\t\t\t\t\t</li>\r\n\r\n\t\t\t\t\t\t<br/>\r\n\r\n\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t<div><b>Popular page</b></div>\r\n\t\t\t\t\t\t\tThis is an overlooked feature in e621, mostly because its UI is\r\n\t\t\t\t\t\t\tso outdated; but it has been incorporated into Sucralose with a\r\n\t\t\t\t\t\t\tlittle better interface.\r\n\t\t\t\t\t\t</li>\r\n\r\n\t\t\t\t\t\t<br/>\r\n\r\n\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t<div><b>Search everything, everywhere</b></div>\r\n\t\t\t\t\t\t\tThe previous version of Sucralose did not let you search hot,\r\n\t\t\t\t\t\t\tfavorites, sets, etc. All of this is fixed in this version.\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</p>\r\n\t\t\t</TutorialModal>\r\n\t\t);\r\n\t}\r\n}];\r\n\r\nexport function NavigationButtonsComponent({ className, tooltipMode = false }) {\r\n\treturn (\r\n\t\t<div className={className || \"ButtonsContainer\"}>\r\n\t\t\t<div className=\"Left\">\r\n\t\t\t\t{ window.location.hash.length > 1 && (\r\n\t\t\t\t\t<LinkWrapper href=\"#\">\r\n\t\t\t\t\t\t<div className=\"Button\">\r\n\t\t\t\t\t\t\t<Feather.Home/>\r\n\r\n\t\t\t\t\t\t\t<Tooltip direction=\"down\">Home</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</LinkWrapper>\r\n\t\t\t\t) }\r\n\t\t\t\t\r\n\t\t\t\t{[\"posts\", \"hot\", \"popular\", \"sets\"].map(path => (\r\n\t\t\t\t\t<LinkWrapper key={path} href={\"#\" + path}>\r\n\t\t\t\t\t\t<div className=\"Button\">\r\n\t\t\t\t\t\t\t{NavigationButtons[path].icon}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{ tooltipMode ? (\r\n\t\t\t\t\t\t\t\t<Tooltip direction=\"down\">\r\n\t\t\t\t\t\t\t\t\t{NavigationButtons[path].title}\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"Title\">\r\n\t\t\t\t\t\t\t\t\t{NavigationButtons[path].title}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</LinkWrapper>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"Right\">\r\n\t\t\t\t{[\"subscriptions\", \"favorites\", \"upvoted\", \"settings\"].map(path => (\r\n\t\t\t\t\t<LinkWrapper key={path} href={\"#\" + path}>\r\n\t\t\t\t\t\t<div className={joinClassNames(\"Button HasTooltip\", [!App.user, \"Disabled\"])}>\r\n\t\t\t\t\t\t\t{NavigationButtons[path].icon}\r\n\r\n\t\t\t\t\t\t\t{ tooltipMode ? (\r\n\t\t\t\t\t\t\t\t<Tooltip direction=\"down\">\r\n\t\t\t\t\t\t\t\t\t{NavigationButtons[path].title}\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"Title\">\r\n\t\t\t\t\t\t\t\t\t{NavigationButtons[path].title}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</LinkWrapper>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default function Home() {\r\n\tconst news = newsPosts[newsPosts.length - 1];\r\n\t\r\n\treturn (\r\n\t\t<div className=\"MainPage\">\r\n\t\t\t<div className=\"Head\">\r\n\t\t\t\t<h1>Sucralose!</h1>\r\n\t\t\t\t<div>A sweeter way to use <a href=\"https://e621.net\">e621</a>.</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<SearchField/>\r\n\t\t\t\r\n\t\t\t<NavigationButtonsComponent/>\r\n\t\t\t\r\n\t\t\t{ window.navigator.userAgent.indexOf(\"Firefox\") !== -1 && (\r\n\t\t\t\t<div className=\"UseAModernWebBrowserThatActuallySupportsBackdropFilterAndOtherFeaturesFromMoreThan5YearsAgo\">\r\n\t\t\t\t\t<h2>WARNING</h2>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div>You're on an unsupported web browser.</div>\r\n\t\t\t\t\t<div>You will likely experience visual and functional errors.</div>\r\n\t\t\t\t\t<div>Please do not report these while on an unsupported browser.</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<br/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div>Most modern Chromium-based browsers are supported.</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<br/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div style={{ color: \"var(--txt-color)\" }}>\r\n\t\t\t\t\t\t<a href=\"https://www.google.com/chrome/\">Chrome</a>,\r\n\t\t\t\t\t\t<a href=\"https://www.opera.com/download\">Opera</a>,\r\n\t\t\t\t\t\t<a href=\"https://www.opera.com/gx\">Opera GX</a>,\r\n\t\t\t\t\t\t<a href=\"https://brave.com/download/\">Brave</a>,\r\n\t\t\t\t\t\t<a href=\"https://www.microsoft.com/en-us/edge\">Literally Edge</a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t) }\r\n\t\t\t\r\n\t\t\t<div className=\"News\" onClick={() => Modals.push(news.modal())}>\r\n\t\t\t\t<h3 className=\"Title\">{news.title}</h3>\r\n\t\t\t\t\r\n\t\t\t\t<div className=\"Flex\">\r\n\t\t\t\t\t<div className=\"Date\">{news.date}</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div className=\"Poster\">by <b>Metalloriff</b></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}","import React from \"react\";\r\nimport \"./TagItem.scss\";\r\nimport * as Feather from \"react-feather\";\r\nimport ContextMenu from \"../ContextMenuHandler\";\r\nimport SearchField from \"../General/SearchField\";\r\nimport Database from \"../../Classes/Database\";\r\nimport Toasts from \"../Toasts\";\r\nimport App from \"../../App\";\r\nimport LinkWrapper from \"../LinkWrapper\";\r\n\r\n/* TODO\r\n    \r\n    Replace tagInfo event with custom modal.\r\n    \r\n */\r\n\r\nexport default function TagItem({ children }) {\r\n    return (\r\n        <ContextMenu.Wrapper menu={<TagItemContextMenu tag={children}/>} wrapperClassName=\"TagItemContextMenuWrapper\">\r\n            <LinkWrapper className=\"TagItem\" onClick={() => SearchField.handleSearch(children)}\r\n                         href={`?search=${children}#posts`}>\r\n                {children}\r\n            </LinkWrapper>\r\n        </ContextMenu.Wrapper>\r\n    )\r\n}\r\n\r\nexport function TagItemContextMenu({ tag }) {\r\n    const events = {\r\n        appendToSearch: () =>\r\n            SearchField.handleSearch(SearchField.value.trim() + \" \" + tag),\r\n        subscribe: () => {\r\n            App.userData.subscriptions.push(tag);\r\n            \r\n            Database.update(App.userData, \"users\", App.user.uid)\r\n                .then(() => Toasts.showToast(<span>Added <b>{tag}</b> to subscribed tags</span>))\r\n                .catch(err => (console.error(err), Toasts.showToast(\"An unknown error occurred\", \"Failure\")));\r\n        },\r\n        unsubscribe: () => {\r\n            \r\n        },\r\n        blacklist: () => {\r\n            \r\n        },\r\n        tagInfo: () => {\r\n            window.open(`https://e621.net/wiki_pages/${tag}`, \"_blank\");\r\n        }\r\n    };\r\n    \r\n    return (\r\n        <ContextMenu>\r\n            <ContextMenu.Item\r\n                autoClose\r\n                icon={<Feather.Plus/>}\r\n                onClick={events.appendToSearch}\r\n            >Append To Search Tags</ContextMenu.Item>\r\n            \r\n            <ContextMenu.Divider/>\r\n            \r\n            { App.userData && (\r\n                <React.Fragment>\r\n                    { ~App.userData.subscriptions.indexOf(tag.toLowerCase()) ? (\r\n                        <ContextMenu.Item\r\n                            autoClose\r\n                            icon={<Feather.BellOff/>}\r\n                            onClick={events.unsubscribe}\r\n                        >Unsubscribe</ContextMenu.Item>\r\n                    ) : (\r\n                        <ContextMenu.Item\r\n                            autoClose\r\n                            icon={<Feather.Bell/>}\r\n                            onClick={events.subscribe}\r\n                        >Subscribe</ContextMenu.Item>\r\n                    ) }\r\n\r\n                    <ContextMenu.Item\r\n                        autoClose\r\n                        icon={<Feather.EyeOff/>}\r\n                        onClick={events.blacklist}\r\n                    >Blacklist</ContextMenu.Item>\r\n\r\n                    <ContextMenu.Divider/>\r\n                </React.Fragment>\r\n            ) }\r\n            \r\n            <ContextMenu.Item\r\n                autoClose\r\n                icon={<Feather.HelpCircle/>}\r\n                onClick={events.tagInfo}\r\n            >Tag Info</ContextMenu.Item>\r\n        </ContextMenu>\r\n    );\r\n}","import React from \"react\";\r\nimport \"./TabsList.scss\";\r\n\r\nexport default class extends React.Component {\r\n\tstate = { active: null };\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setState({ active: 0 });\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst children = React.Children.toArray(this.props.children);\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div className=\"TabsList\">\r\n\t\t\t\t\t{ this.props.tabs.map((title, index) => (\r\n\t\t\t\t\t\t<span key={title} className={\"TabItem\" + (index === this.state.active ? \" Active\" : \"\")} onClick={() => {\r\n\t\t\t\t\t\t\tthis.setState({ active: index });\r\n\r\n\t\t\t\t\t\t\tif (this.props.onChange) {\r\n\t\t\t\t\t\t\t\tthis.props.onChange(title, index, this);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t<span className=\"TabItemTitle\">{ title }</span>\r\n\t\t\t\t\t\t\t<div className=\"TabItemBorder\"/>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t)) }\r\n\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t{ children.map((child, i) => (\r\n\t\t\t\t\t<div className=\"TabItem\" key={i}\r\n\t\t\t\t\t\t style={{ display: this.state.active === i ? \"block\" : \"none\" }}>\r\n\t\t\t\t\t\t{ child }\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)) }\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport \"./AuthModal.scss\";\r\nimport * as Feather from \"react-feather\";\r\nimport { Modals } from \"../Modals\";\r\nimport Toasts from \"../Toasts\";\r\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword } from \"firebase/auth\";\r\nimport Database from \"../../Classes/Database\";\r\nimport { useEventListener } from \"../../Classes/Hooks\";\r\n\r\n// TODO add password reset functionality.\r\n\r\nexport default function AuthModal() {\r\n    const [signUpMode, setSignUpMode] = React.useState(false);\r\n    const [busy, setBusy] = React.useState(false);\r\n    const ref = React.useRef();\r\n    \r\n    // Create an events object.\r\n    const events = {\r\n        handleSignUp: () => {\r\n            if (busy) return;\r\n            \r\n            // Get the input fields.\r\n            const [emailField, passwordField, confirmPasswordField] = ref.current.getElementsByTagName(\"input\");\r\n            \r\n            // If the passwords don't match, throw an error to the user and return.\r\n            if (confirmPasswordField.value !== passwordField.value)\r\n                return Toasts.showToast(\"Passwords must match!\", \"Failure\");\r\n            // If the email doesn't exist, throw an error to the user and return.\r\n            if (!emailField.value.trim())\r\n                return Toasts.showToast(\"You must input an email address\", \"Failure\");\r\n            // If the password is empty, throw an error to the user and return.\r\n            if (!passwordField.value.trim())\r\n                return Toasts.showToast(\"You must input a password\", \"Failure\");\r\n            \r\n            // Set the busy state so users don't spam the API.\r\n            setBusy(true);\r\n            \r\n            // Create the user account.\r\n            createUserWithEmailAndPassword(Database.auth, emailField.value, passwordField.value)\r\n                // Then navigate to the settings.\r\n                .then(() => (Modals.pop(), Toasts.showToast(\"Welcome to Sucralose!\", \"Success\"), window.location.hash = \"#settings\"))\r\n                // Catch any errors that may have occurred.\r\n                .catch(e => {\r\n                    Toasts.showToast(\"An unknown error has occured! Check console for details\", \"Failure\");\r\n                    console.error(e);\r\n                });\r\n        },\r\n        handleLogIn: () => {\r\n            if (busy) return;\r\n\r\n            // Get the input fields.\r\n            const [emailField, passwordField] = ref.current.getElementsByTagName(\"input\");\r\n            \r\n            // Set the busy state so users don't spam the API.\r\n            setBusy(true);\r\n            \r\n            // Attempt to log in.\r\n            signInWithEmailAndPassword(Database.auth, emailField.value, passwordField.value)\r\n                // Then reload the page because I'm lazy.\r\n                .then(() => (Modals.pop(), window.location.reload()))\r\n                // Catch any errors that may have occurred.\r\n                .catch(e => {\r\n                    let message = \"Unknown\";\r\n                    \r\n                    switch (e.code) {\r\n                        case \"auth/invalid-email\":\r\n                            message = \"Invalid email address\";\r\n                            break;\r\n                            \r\n                        case \"auth/user-not-found\":\r\n                            message = \"No user with this email found\";\r\n                            break;\r\n                            \r\n                        case \"auth/wrong-password\":\r\n                            message = \"Incorrect password\";\r\n                            break;\r\n                    }\r\n                    \r\n                    Toasts.showToast(`Failed to sign in! Reason - ${message}`, \"Failure\", 10);\r\n                    console.error(e);\r\n                });\r\n        }\r\n    };\r\n    \r\n    useEventListener(\r\n        \"keydown\",\r\n        e => e.key === \"Enter\" && (signUpMode ? events.handleSignUp() : events.handleLogIn())\r\n    );\r\n    \r\n    return (\r\n        <div className=\"AuthModal\" ref={ref}>\r\n            <Feather.X className=\"CloseButton\" onClick={Modals.pop.bind(Modals)}/>\r\n            \r\n            { signUpMode ? (\r\n                <React.Fragment>\r\n                    <div className=\"MainSection Flex\">\r\n                        <div className=\"HelpSection\">\r\n                            <div className=\"Title\">NOTE</div>\r\n\r\n                            <div>\r\n                                This is not your e621.net details.<br/>\r\n                                You will have the option to enter<br/>\r\n                                your e621.net username and API key<br/>\r\n                                in your settings after signing up.<br/>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div className=\"Fields\">\r\n                            <h3>Sign Up</h3>\r\n\r\n                            <div className=\"FieldContainer\">\r\n                                <input type=\"email\" placeholder=\"Email Address\"/>\r\n                            </div>\r\n\r\n                            <div className=\"FieldContainer\">\r\n                                <input type=\"password\" placeholder=\"Password\"/>\r\n                            </div>\r\n\r\n                            <div className=\"FieldContainer\">\r\n                                <input type=\"password\" placeholder=\"Confirm Password\"/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"FooterSection Flex\">\r\n                        <div className=\"Button\" onClick={() => setSignUpMode(false)}>\r\n                            <Feather.LogIn/>\r\n                            <div>Log In</div>\r\n                        </div>\r\n\r\n                        <div className=\"Button\" style={{ marginLeft: \"auto\" }} onClick={events.handleSignUp}>\r\n                            <Feather.UserCheck/>\r\n                            <div>Sign Up</div>\r\n                        </div>\r\n                    </div>\r\n                </React.Fragment>\r\n            ) : (\r\n                <React.Fragment>\r\n                    <div className=\"MainSection Flex\">\r\n                        <div className=\"HelpSection\">\r\n                            <div className=\"Title\">Why?</div>\r\n\r\n                            <div>\r\n                                Having an account ensures that your data<br/>\r\n                                stays consistent across browsers and devices,<br/>\r\n                                along with giving you access to useful features,<br/>\r\n                                without the security risks of storing data on your device.<br/>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div className=\"Fields\">\r\n                            <h3>Login</h3>\r\n                            \r\n                            <div className=\"FieldContainer\">\r\n                                <input type=\"email\" placeholder=\"Email Address\"/>\r\n                            </div>\r\n\r\n                            <div className=\"FieldContainer\">\r\n                                <input type=\"password\" placeholder=\"Password\"/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"FooterSection Flex\">\r\n                        <div className=\"Button\" onClick={() => setSignUpMode(true)}>\r\n                            <Feather.UserPlus/>\r\n                            <div>Sign Up</div>\r\n                        </div>\r\n                        \r\n                        <div className=\"Button\" style={{ marginLeft: \"auto\" }}>\r\n                            <Feather.Key/>\r\n                            <div>Reset Password</div>\r\n                        </div>\r\n                        \r\n                        <div className=\"Button\" onClick={events.handleLogIn}>\r\n                            <Feather.LogIn/>\r\n                            <div>Log In</div>\r\n                        </div>\r\n                    </div>\r\n                </React.Fragment>\r\n            ) }\r\n        </div>\r\n    )\r\n}","import React from \"react\";\r\nimport \"./PostsPage.scss\";\r\nimport Posts from \"../Components/Posts/Posts\";\r\nimport Header from \"../Components/General/Header\";\r\nimport App from \"../App\";\r\n\r\nfunction formatDate(date) {\r\n    return [date.getUTCDate(), date.getMonth() + 1, date.getFullYear()].join(\"-\");\r\n}\r\n\r\nexport default function PopularPostsPage() {\r\n    const wtf = new Date();\r\n    const [date, setDate] = React.useState(\r\n        formatDate(\r\n            new Date(\r\n                `${wtf.getFullYear()}-${(wtf.getUTCMonth() + 1).toString().padStart(2, \"0\")}-${(wtf.getDay() + 1).toString().padStart(2, \"0\")} 0:00`\r\n            )\r\n        )\r\n    );\r\n    \r\n    return (\r\n        <div className=\"PostsPage\">\r\n            <Header hasSearch={false}/>\r\n            \r\n            <div className=\"DatePicker\">\r\n                <h2>Date</h2>\r\n                \r\n                <input type=\"date\" ref={e => e && !e.value ? e.valueAsDate = new Date() : null}\r\n                       onInput={e => setDate(formatDate(new Date(e.target.value)))}/>\r\n            </div>\r\n\r\n            { App.userReady && <Posts request={[\"explore/posts/popular\", { date, scale: \"day\" }]}/> }\r\n        </div>\r\n    )\r\n}","var _defs, _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgKermit(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    style: {\n      isolation: \"isolate\"\n    },\n    viewBox: \"0 0 1024 1024\",\n    width: \"1024pt\",\n    height: \"1024pt\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"_clipPath_VLhmLKF27nF926q38ytCl20StHRMDv8J\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 1024,\n    height: 1024\n  })))), /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#_clipPath_VLhmLKF27nF926q38ytCl20StHRMDv8J)\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 1024,\n    height: 1024,\n    style: {\n      fill: \"rgb(42,42,42)\"\n    },\n    fillOpacity: 0\n  }), _g || (_g = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    d: \" M 391.435 916.828 Q 471.605 721.151 545.738 636.285 C 619.871 551.418 594.377 545.715 537.688 472.589 C 480.998 399.462 436.719 312.918 387.409 291.45 L 391.435 264.614 Q 680.586 344.45 724.193 333.045 Q 515.548 293.462 449.131 264.614 C 382.713 235.766 383.049 223.355 396.802 209.602 C 410.555 195.849 517.226 135.134 572.574 125.07 Q 627.922 115.007 631.611 119.703 Q 718.826 81.128 751.029 161.298 Q 869.999 277.138 857.029 425.627 C 844.058 574.116 851.214 611.238 869.105 638.968 C 886.995 666.698 978.235 769.795 967.054 916.828 L 967.054 916.828 L 391.435 916.828 Z \",\n    fill: \"currentColor\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \" M 546.384 682.698 C 540.011 678.17 349.479 687.059 264.612 657.205 Q 179.746 627.35 244.486 469.357 Q 327.843 456.275 401.473 260.041 L 174.714 113.788 Q 26.467 257.191 63.347 368.724 Q 84.145 431.62 159.954 457.281 Q 105.277 689.575 206.916 733.685 Q 308.555 777.796 500.764 772.597 Q 552.757 687.227 546.384 682.698 Z \",\n    fill: \"currentColor\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \" M 646.718 129.096 Q 670.87 129.096 653.427 150.564 Q 659.8 170.104 654.769 173.374 Q 649.737 176.645 644.035 154.589 Q 617.912 136.392 646.718 129.096 Z \",\n    fill: \"var(--primary-bg)\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgKermit);\nexport default __webpack_public_path__ + \"static/media/Kermit.4ed5c4d0.svg\";\nexport { ForwardRef as ReactComponent };","import React from \"react\";\r\nimport \"./PostComments.scss\";\r\nimport { useInterval } from \"../../Classes/Hooks\";\r\nimport API from \"../../Classes/API\";\r\nimport InlineLoading from \"../InlineLoading\";\r\nimport { ReactComponent as Kermit } from \"../../Icons/Kermit.svg\";\r\nimport LinkWrapper from \"../LinkWrapper\";\r\nimport { joinClassNames } from \"../../Classes/Constants\";\r\nimport * as Feather from \"react-feather\";\r\nimport App from \"../../App\";\r\n\r\n/* TODO\r\n\r\n    Add voting on comments.\r\n    Add timestamps.\r\n    Add the ability to post comments.\r\n    Handle deleted comments.\r\n\r\n */\r\n\r\nexport default function PostComments({ id }) {\r\n    const [comments, setComments] = React.useState(null);\r\n    \r\n    useInterval(() => {\r\n        API.request(`posts/${id}/comments`).then(data => {\r\n            const doc = new DOMParser().parseFromString(data.html, \"text/html\");\r\n            \r\n            setComments(\r\n                [...doc.getElementsByClassName(\"comment\")].map(comment => ({\r\n                    id: comment.dataset.commentId,\r\n                    userId: comment.dataset.creatorId,\r\n                    username: comment.dataset.creator,\r\n                    score: parseInt(comment.dataset.score),\r\n                    isDeleted: comment.dataset.isDeleted === \"true\",\r\n                    body: comment.querySelector(\".content > .body\")?.innerHTML,\r\n                    avatarPost: data.posts[comment.querySelector(\r\n                        \".avatar > .placeholder\"\r\n                    )?.dataset.id],\r\n                    timestamp: comment.querySelector(\"time\")?.dateTime\r\n                }))\r\n            );\r\n        });\r\n    }, 10000, true);\r\n    \r\n    return (\r\n        <div className=\"PostComments\">\r\n            { comments === null ? (\r\n                <InlineLoading/>\r\n            ) : (\r\n                comments.length === 0 ? (\r\n                    <div className=\"NoComments\">\r\n                        <h1>No comment.</h1>\r\n                        \r\n                        <Kermit className=\"Kermit\"/>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"Comments\">\r\n                        {comments.map(comment => (\r\n                            <div className=\"Comment\" key={comment.id}>\r\n                                <div className=\"UserSection\">\r\n                                    <div className=\"AvatarContainer\">\r\n                                        <div className=\"AvatarPlaceholder FlexCenter\">\r\n                                            <Feather.User/>\r\n                                        </div>\r\n                                        \r\n                                        <LinkWrapper href={`#post/${comment.avatarPost?.id ?? \"not_found\"}`}>\r\n                                            <img\r\n                                                className={joinClassNames(\"Avatar\", [comment.avatarPost?.rating === \"e\", \"NSFW\"])}\r\n                                                src={comment.avatarPost?.cropped_url}\r\n                                                onError={({ target }) => target.src = comment.avatarPost?.preview_url }\r\n                                                alt=\"\"\r\n                                            />\r\n                                        </LinkWrapper>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <div className=\"BodySection\">\r\n                                    <LinkWrapper href={`#user/${comment.userId}`}>\r\n                                        <div className=\"Username\">\r\n                                            {comment.username}\r\n                                        </div>\r\n                                    </LinkWrapper>\r\n                                    \r\n                                    <div\r\n                                        className=\"Body\"\r\n                                        dangerouslySetInnerHTML={{ __html: comment.body }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )\r\n            ) }\r\n            \r\n            { App.e621User && (\r\n                <div className=\"CommentCreatorSection Comments\">\r\n                    <div className=\"Comment\">\r\n                        <div className=\"UserSection\">\r\n                            <div className=\"AvatarContainer\">\r\n                                <div className=\"AvatarPlaceholder FlexCenter\">\r\n                                    <Feather.User/>\r\n                                </div>\r\n\r\n                                <LinkWrapper href={`#post/${App.e621User.avatarPost?.id ?? \"not_found\"}`}>\r\n                                    <img\r\n                                        className={joinClassNames(\"Avatar\", [App.e621User.avatarPost?.rating === \"e\", \"NSFW\"])}\r\n                                        src={App.e621User.avatarPost?.cropped_url}\r\n                                        onError={({ target }) => target.src = App.e621User.avatarPost?.preview_url }\r\n                                        alt=\"\"\r\n                                    />\r\n                                </LinkWrapper>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"BodySection Flex\">\r\n                            <textarea className=\"Body\" placeholder=\"This doesn't do anything yet. I got lazy.\"/>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            ) }\r\n        </div>\r\n    )\r\n}","import React from \"react\";\r\nimport \"./PostPage.scss\";\r\nimport Header from \"../Components/General/Header\";\r\nimport API from \"../Classes/API\";\r\nimport * as Feather from \"react-feather\";\r\nimport TabsList from \"../Components/TabsList\";\r\nimport PostComments from \"../Components/Posts/PostComments\";\r\nimport TagItem from \"../Components/Posts/TagItem\";\r\nimport _ from \"lodash\";\r\nimport { formatBytes } from \"../Classes/Constants\";\r\n\r\nexport default function PostPage({ id }) {\r\n    const [post, setPostData] = React.useState(null);\r\n    const [failed, setFailedState] = React.useState(false);\r\n    const [, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n    \r\n    React.useEffect(() => {\r\n        API.request(`posts/${id}`)\r\n            .then(post => post?.post ? setPostData(post.post) : setFailedState(true))\r\n            .catch(err => (console.error(err), setFailedState(true)));\r\n    }, []);\r\n    \r\n    const events = {\r\n        toggleFavorite: () => {\r\n            if (post.is_favorited)\r\n                // Remove the post from the favorites list.\r\n                API.removeFavorite(id).then(() => (post.is_favorited = false, forceUpdate()));\r\n            else\r\n                // Add the post to the favorites list.\r\n                API.favorite(id).then(() => (post.is_favorited = true, forceUpdate()));\r\n        },\r\n        vote: score =>\r\n            // Vote on the post.\r\n            API.vote(id, score).then(data => (_.extend(post.score, data), forceUpdate()))\r\n    };\r\n    \r\n    return (\r\n        <div className=\"PostPage\">\r\n            <Header/>\r\n            \r\n            { post ? (\r\n                <div className=\"PostBody\">\r\n                    <div className=\"ImageContainer\">\r\n                        <img className=\"Image\"\r\n                             src={post.file.url}\r\n                             {...{}/* If you can write lazier code than this, I will do nothing because I'm too lazy. */}\r\n                             {...{}/* TODO not this */}\r\n                             onError={({ target }) =>\r\n                                 target.outerHTML = target.outerHTML.replace(\"img\", \"video\")}\r\n                             loop controls\r\n                             alt=\"Post Image\"/>\r\n                    </div>\r\n                    \r\n                    <div className=\"PostBodyMain\">\r\n                        <div\r\n                            className=\"Button\"\r\n                            style={{ color: post.score.our_score === 1 ? \"var(--primary-color)\" : null }}\r\n                            onClick={events.vote.bind(null, 1)}\r\n                        >\r\n                            <Feather.ThumbsUp/>\r\n                            <div>{post.score.up}</div>\r\n                        </div>\r\n                        \r\n                        <div\r\n                            className=\"Button\"\r\n                            style={{ color: post.score.our_score === -1 ? \"var(--primary-color)\" : null }}\r\n                            onClick={events.vote.bind(null, -1)}\r\n                        >\r\n                            <Feather.ThumbsDown/>\r\n                            <div>{-post.score.down}</div>\r\n                        </div>\r\n\r\n                        <div\r\n                            className=\"Button\"\r\n                            style={{ color: post.is_favorited ? \"var(--red)\" : null }}\r\n                            onClick={events.toggleFavorite}\r\n                        >\r\n                            <Feather.Heart/>\r\n                            <div>{post.fav_count}</div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    { post.description && (\r\n                        <div className=\"PostDescriptionContainer Flex\">\r\n                            <div className=\"PostDescription\">\r\n                                {post.description}\r\n                            </div>\r\n                        </div>\r\n                    ) }\r\n                    \r\n                    <TabsList tabs={[\"Comments\", \"Tags\", \"Details\"]}>\r\n                        <PostComments id={id}/>\r\n                        \r\n                        <div className=\"TagsList\">\r\n                            {Object.keys(post.tags).filter(tc => post.tags[tc].length).reverse().map(category => (\r\n                                <div className=\"TagCategory\" key={category}>\r\n                                    <h2>{category} - {post.tags[category].length}</h2>\r\n                                    \r\n                                    <div className=\"Tags\">\r\n                                        {post.tags[category].map((tag, index) => (\r\n                                            <TagItem key={index}>\r\n                                                {tag}\r\n                                            </TagItem>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                        \r\n                        <div className=\"PostDetails Flex\">\r\n                            <div>\r\n                                <div className=\"Entry\">\r\n                                    <h2>Post ID</h2>\r\n                                    <div>#{id}</div>\r\n                                </div>\r\n\r\n                                <div className=\"Entry\">\r\n                                    <h2>Post MD5 Hash</h2>\r\n                                    <div>{post.file.md5}</div>\r\n                                </div>\r\n\r\n                                <div className=\"Entry\">\r\n                                    <h2>Creation Date</h2>\r\n                                    <div>{post.created_at}</div>\r\n                                </div>\r\n\r\n                                <div className=\"Entry\">\r\n                                    <h2>Size</h2>\r\n                                    <div>{formatBytes(post.file.size)}</div>\r\n                                </div>\r\n\r\n                                <div className=\"Entry\">\r\n                                    <h2>Width</h2>\r\n                                    <div>{post.file.width} pixels</div>\r\n                                </div>\r\n\r\n                                <div className=\"Entry\">\r\n                                    <h2>Height</h2>\r\n                                    <div>{post.file.height} pixels</div>\r\n                                </div>\r\n\r\n                                <div className=\"Entry\">\r\n                                    <h2>Sources</h2>\r\n                                    <div>{\r\n                                        post.sources.map((src, i) => (\r\n                                            <div key={i} style={{ marginTop: 10 }}>\r\n                                                <a href={src}>\r\n                                                    {src}\r\n                                                </a>\r\n                                            </div>\r\n                                        ))\r\n                                    }</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </TabsList>\r\n                </div>\r\n            ) : (\r\n                failed ? (\r\n                    <div/>\r\n                ) : (\r\n                    <div/>\r\n                )\r\n            ) }\r\n        </div>\r\n    )\r\n}","export default __webpack_public_path__ + \"static/media/TwemojiHeart.a32c5071.svg\";","import React from \"react\";\r\nimport \"./PageFooter.scss\";\r\nimport * as Feather from \"react-feather\";\r\n\r\nimport Icon from \"../../Assets/icon50x50.png\";\r\nimport Heart from \"../../Assets/TwemojiHeart.svg\";\r\nimport Tooltip from \"../Tooltip\";\r\nimport { copyToClipboard } from \"../Modals\";\r\n\r\nexport default function PageFooter() {\r\n    const contacts = {\r\n        website: () => window.open(\"https://metalloriff.github.io/\", \"_blank\"),\r\n        github: () => window.open(\"https://github.com/metalloriff/\", \"_blank\"),\r\n        twitter: () => window.open(\"https://twitter.com/Metalloriff/\", \"_blank\"),\r\n        email: () => window.open(\"mailto:metalloriff@gmail.com\", \"_blank\"),\r\n        discord: () => copyToClipboard(\"Metalloriff #2891\")\r\n    };\r\n    \r\n    return (\r\n        <footer>\r\n            <div className=\"Flex\">\r\n                <div className=\"LeftSections\">\r\n                    <div className=\"HeadSection FlexCenter\">\r\n                        <img className=\"Logo\" src={Icon} alt=\"Logo\"/>\r\n\r\n                        <div>\r\n                            <h2>Metalloriff</h2>\r\n                            <div>\r\n                                Made with <img src={Heart} alt=\"\" width={15} height={15}/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"ContactSection Flex\">\r\n                        <div className=\"ContactEntry\" onClick={contacts.website}>\r\n                            <Feather.Globe/>\r\n                            <Tooltip>Website</Tooltip>\r\n                        </div>\r\n\r\n                        <div className=\"ContactEntry\" onClick={contacts.github}>\r\n                            <Feather.GitHub/>\r\n                            <Tooltip>GitHub</Tooltip>\r\n                        </div>\r\n\r\n                        <div className=\"ContactEntry\" onClick={contacts.twitter}>\r\n                            <Feather.Twitter/>\r\n                            <Tooltip>Twitter</Tooltip>\r\n                        </div>\r\n\r\n                        <div className=\"ContactEntry\" onClick={contacts.email}>\r\n                            <Feather.Mail/>\r\n                            <Tooltip>Email</Tooltip>\r\n                        </div>\r\n\r\n                        <div className=\"ContactEntry\" onClick={contacts.discord}>\r\n                            <Feather.MessageSquare/>\r\n                            <Tooltip>Discord</Tooltip>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                <div className=\"MiddleSection\">\r\n                    {/*  TODO add some shit here.  */}\r\n                </div>\r\n                \r\n                <div className=\"RightSections FlexCenter\">\r\n                    <div className=\"LinksSection\">\r\n                        <a href=\"https://github.com/Metalloriff/sucralose\">Source Code</a>\r\n                        <a href=\"https://feathericons.com/\">Icons Used</a>\r\n                        <a href=\"https://metalloriff.github.io/city-fog\">Color Palette</a>\r\n                        <a href=\"https://paypal.me/israelboone\">\r\n                            <img src={Heart} alt=\"\" width={15} height={15}/>\r\n                            <span style={{ margin: \"0 7px\" }}>Donate</span>\r\n                            <img src={Heart} alt=\"\" width={15} height={15}/>\r\n                        </a>\r\n                        \r\n                        <div className=\"Copyright\">\r\n                            Copyright  {new Date().getFullYear()} Israel Boone\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </footer>\r\n    );\r\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjEuNWRHWFIAAAawSURBVGhD7VlbT1NZFJ4/5SXRTIaQyMOMiWiMRnzQiTo+6ZviMDMoCCMyCgKCgCgqeEHlMgIzVKRyv5QWgTIWaGmhpVBaKJVSoFC+OWvb1racHnpaaYjhS75Auy9nfWfvtdZeu9/dvNSIb4E7QrYbd4RsN0Yk5K/Ed8hLaeFtizYjElKU0Y5R5QxvW7QZkZDy/F6srbrQ8Pojb3s0GZGQZwW96O+exNSEDY9zenj7RIsRCbmf2YHhARPbYjPGBdxLb+PtFw1GJCSTc3bz1AJuXm5EWZ4MpslPyL/eirdVKvaXb8xWMSIhxEGZEc+L5Ox/2mokZrDXiOUlJ+RtE3iY1bVhzFYwYiEPbnVCr7Uik1sV+lzKGT4/54DBYEBSUhKamppg1FswpJhCY80wHt7eGmERCRnhQq9+zArrrAMt/6q93+debYaq34Tu7m4cOnQIe/fuRUJCAlJSUiCRSDAxZmGr+CS3B0+5VfSdM1yGJeSvK+/w6sEH2KxLaHozAu3ILNbX16Ho0Pv5xsv7fdxqzaGhoQEXL17Evn37sGvXLhw8eBDt7e3sJSzYlnHnj/d+84dD0UIK0loxO7OInp4eKJVKlHBbi74vze6G5qMZzpU1tPyjZmI9Y8ruypi/TE3OoqqqCkeOHMGePXvY/zqdDs1cf0/fcBnWirwoUnAGO9Hb24v6F0N+bRX3FZgzL8LEheNAfyA/evWgDwbdHAoLC9mWO3v2LCbH5/z6hUPRQl6W9GFYpca5c+cQHx+PCc1GI24nNUHWMg6ncw2dTVo8utPt105ntL5OA8rLy9lW6+8fYKtIPlf7TOnXN1SKEkLbaFg1itjYWGYAsba2Fn+XD/L2ryhWYHFhBQRKmM8LP4dpIq3OuHoOJ0+eRE1NDROVk5MDq9WK1w8/+M0TCkUJ0Y1acOLECa8I4oEDBzBpmEbxzQ7eMeT8k+PzTIzLtc5tvT5vW9XjfpSWliIuLg7aMT3aJBoWolt9ImCoDFkIhcv6+no/ER7SPp+Zmg96RLn1axMkdV1IT0/HtHEWt7nP9D1tOZPJhOTkZBauA8eJYchCNCozjh8/zivk9OnTsFgsLBxTggwc+0vCdW/furo6FnIpILjW1tlKUeg2cgfPwHFiGJKQ8nwZy9C+xnt44cIFLC8vM4MIK8urqHrU7zc+/sefWd8zZ85gbW3N3XMjuqRadm7zHRsqNxWS/bsUep2Fxf5AEbRCDofDbYY/FO16ZCVJkXHpLWK+j2MBYnp62t0K2Gw25uDXrl1lTk45iaCUG5GT3MxrixAFhdz7sw3jGgsSExM3iKAcMDIywh4eDD2d/Yj94SfWv7q62v3tRpjNZuZ/HjFLjlVI60a9vhQKeYVQnO98p4V5Zha5ubksshw9etRPSGpqKnuoEFZXV3H+/HmcOnWK+YFY2OaW8OYpF9pD2G5BV+QVl/iU8ilYpu1QKBSIiYnxE6LRaNyPE8b8/PymK7cZDLp5dgTis9NDwa11N7UFOq1+gwg6yUYblIOoIuWzkygopLVBg7S0ND8RxPz8fPf00UVlqX809KWgkNEhM4tWu3fvxuHDh71CpFKpe+rIYTQaYbfb3Z+EUVka/OgiKIQuFo4dO8bqCa1W6xUil8vdU0cOl8vF1SZtqKioQHFxEcv+2dlZKCkpgVqtdvf6DCrE+OwkCgqR1o6wo7q8fYIrgma9vtLR0eGeWjxWnS6W2R1256aRTCbr8QYV8hHKaXx2EgWF5F1r5mK6kzk9icrIyGBCKisr2eRiMCCbZJEn8/KXgivrNymGuMhIRxU+TXTkKctvY8UaHTx9bQukoBCip6amclTHnVD379+PGzduuB8VGuglBM7rIeUsaqc6hN66L+yfVlif91xyrK/wL+ACuakQX0oqP6KsrIw5fqiwmOzeG5bN2Fitco/6DM8LoAzvu5J8FCWEDKJTMB0UBwcH3Y8TRvd7He9cwUgXEh5UPx7g7cNHUUKI5Dd6nQkFBQXuxwlDUqXinScYqZQm0DYT85OFaCFEyrD6cRMWFxfZQ4VA+5tvjmAkn6FETLeVfO3BGJYQIr2tMZXFbW5wTOltIfuIh3R5kZMs7q4rbCEe1j5XctHlS2HFh74Ovd8911YwYiFEWh26bRQCRS/6QYhyEt8ckfKrCPGw+skAu/bZDFaLA+r/zPjQaWD3Xi+KFaK3XyC/qhAPn+TJ0MUZSPdW9oUVb6KjIwnV9PSbCmV0SaUKhVwVyjeHWG6JkEBSJKKkdutK6KWrWEZFSDS4I2S7cUfIduM3IqQR/wPMTZmSnhx+ZgAAAABJRU5ErkJggg==\"","import React from \"react\";\r\nimport \"./SwitchItem.scss\";\r\n\r\nexport default function SwitchItem({ title, defaultValue, callback }) {\r\n    return (\r\n        <div className=\"SwitchItem\">\r\n            <h3 style={{ margin: 0 }}>{title}</h3>\r\n            \r\n            <input className=\"Switch\"\r\n                   type=\"checkbox\"\r\n                   defaultChecked={defaultValue}\r\n                   onInput={e => callback?.(e.currentTarget.checked)}/>\r\n        </div>\r\n    );\r\n}","import React from \"react\";\r\nimport \"./CreateSetModal.scss\";\r\nimport TutorialModal from \"./TutorialModal\";\r\nimport SwitchItem from \"../SwitchItem\";\r\nimport API from \"../../Classes/API\";\r\nimport { Plus } from \"react-feather\";\r\nimport Toasts from \"../Toasts\";\r\nimport { Modals } from \"../Modals\";\r\nimport App from \"../../App\";\r\n\r\nexport default function CreateSetModal({ postId }) {\r\n    const ref = React.useRef();\r\n    \r\n    async function create() {\r\n        const [name, shortname, description] = [...ref.current.getElementsByClassName(\"Field\")]\r\n            .map(field => field.value);\r\n        const is_public = ref.current.querySelector(\".SwitchItem > input\").checked;\r\n        const transfer_on_delete = true;\r\n        const commit = \"Create\";\r\n        \r\n        const response = await API.request(\r\n            \"post_sets\",\r\n            {\r\n                \"post_set[name]\": name,\r\n                \"post_set[shortname]\": shortname,\r\n                \"post_set[description]\": description,\r\n                \"post_set[is_public]\": is_public ? 1 : 0,\r\n                \"post_set[transfer_on_delete]\": transfer_on_delete ? 1 : 0,\r\n                commit\r\n            },\r\n            true,\r\n            {\r\n                method: \"POST\"\r\n            }\r\n        );\r\n        \r\n        if (response.errors) {\r\n            for (const category in response.errors) {\r\n                Toasts.showToast(\r\n                    <div>\r\n                        <h4>{category} errors</h4>\r\n                        \r\n                        <ul style={{ textAlign: \"left\" }}>\r\n                            {response.errors[category].map((err, i) => (\r\n                                <li key={i}>\r\n                                    {err}\r\n                                </li>\r\n                            ))}\r\n                        </ul>\r\n                        \r\n                        <p>Click to dismiss.</p>\r\n                    </div>,\r\n                    \"\",\r\n                    20\r\n                )\r\n            }\r\n        }\r\n        else {\r\n            await API.request(\r\n                `post_sets/${response.id}/add_posts`,\r\n                { \"post_ids[]\": postId },\r\n                true,\r\n                { method: \"POST\" }\r\n            );\r\n            \r\n            response.post_ids.push(postId);\r\n            App.userData?.sets.push(response);\r\n            \r\n            Toasts.showToast(\"Successfully created set\", \"Success\");\r\n            await Modals.pop();\r\n        }\r\n    }\r\n    \r\n    return (\r\n        <TutorialModal title=\"Create New Set\">\r\n            <div className=\"CreateSetModal\" ref={ref}>\r\n                <div className=\"FieldContainer\">\r\n                    <h3>Name</h3>\r\n\r\n                    <input\r\n                        className=\"Field\"\r\n                        placeholder=\"Ex - Epic Dragons\"\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"FieldContainer\">\r\n                    <h3>Short Name</h3>\r\n                    <div className=\"Note\">\r\n                        The short name is used for the set's metatag name, or a unique identifier.<br/>\r\n                        It can only contain letters, numbers, and underscores.\r\n                    </div>\r\n\r\n                    <input\r\n                        className=\"Field\"\r\n                        placeholder=\"Ex - epic_dragons\"\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"FieldContainer\">\r\n                    <h3>Description</h3>\r\n\r\n                    <textarea\r\n                        className=\"Field\"\r\n                        placeholder=\"Note - Follows DText markdown formatting\"\r\n                    />\r\n                </div>\r\n                \r\n                <div className=\"FieldContainer\">\r\n                    <SwitchItem\r\n                        title=\"Public\"\r\n                        callback={null}\r\n                    />\r\n                    \r\n                    <div className=\"Note\">\r\n                        Public sets will be visible to anyone.<br/>\r\n                        Private sets will only be visible to you.\r\n                    </div>\r\n                </div>\r\n                \r\n                <div className=\"FieldContainer\">\r\n                    <div className=\"Button\" onClick={create}>\r\n                        <Plus/>\r\n                        \r\n                        Create Set\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </TutorialModal>\r\n    );\r\n}","import React from \"react\";\r\nimport \"./Post.scss\";\r\nimport * as Feather from \"react-feather\";\r\nimport Tooltip from \"../Tooltip\";\r\nimport { download, joinClassNames } from \"../../Classes/Constants\";\r\nimport Posts from \"./Posts\";\r\nimport { copyToClipboard, Modals, openImageModal } from \"../Modals\";\r\nimport API from \"../../Classes/API\";\r\nimport _ from \"lodash\";\r\nimport TagItem from \"./TagItem\";\r\nimport InlineLoading from \"../InlineLoading\";\r\nimport ContextMenu from \"../ContextMenuHandler\";\r\nimport Toasts from \"../Toasts\";\r\nimport App from \"../../App\";\r\nimport { Settings, SettingsRenderer } from \"../../Pages/SettingsPage\";\r\nimport LinkWrapper from \"../LinkWrapper\";\r\nimport CreateSetModal from \"../Modals/CreateSetModal\";\r\n\r\n/**\r\n * The generic post component.\r\n * @param post {e621Post}\r\n * @constructor\r\n */\r\nexport default function Post({ post }) {\r\n    // De-structure the post object.\r\n    const {\r\n        id,\r\n        description,\r\n        sample,\r\n        file,\r\n        preview,\r\n        fav_count,\r\n        is_favorited,\r\n        score,\r\n        flags,\r\n        created_at,\r\n        rating,\r\n        tags\r\n    } = post;\r\n    \r\n    // Get the preview image URL without fail.\r\n    const previewImage = sample?.url ?? preview?.url ?? file?.url;\r\n    \r\n    // Create some states.\r\n    const [tooltipText, setTooltipText] = React.useState(\"\");\r\n    const [tooltipSide, setTooltipSide] = React.useState(\"left\");\r\n    const [busyButtons, setBusyButtons] = React.useState([]);\r\n    const [previewLoaded, setPreviewLoaded] = React.useState(false);\r\n    \r\n    // Create a force updater.\r\n    const [, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n    \r\n    // Create the button component.\r\n    const Button = React.useMemo(() =>\r\n        ({ text, children, onClick, tooltipText, tooltipSide, className }) => {\r\n            const events = {\r\n                onClick,\r\n                onMouseEnter: () => (\r\n                    setTooltipText(tooltipText),\r\n                    setTooltipSide(tooltipSide ?? \"left\")\r\n                ),\r\n                onMouseLeave: () => setTooltipText(\"\")\r\n            };\r\n            \r\n            return (\r\n                <div className={joinClassNames(\"Button\", className)} {...events}>\r\n                    { ~busyButtons.indexOf(tooltipText)\r\n                        ? <Feather.Loader className=\"Spinner\"/>\r\n                        : children }\r\n                    \r\n                    <span>{text}</span>\r\n                </div>\r\n            );\r\n        }, [busyButtons]);\r\n    \r\n    // Create the events object.\r\n    let downloading = false;\r\n    const events = {\r\n        toggleFavorite: () => {\r\n            // Mark the button as busy.\r\n            setBusyButtons([ ...busyButtons, \"Favorite\" ]);\r\n            \r\n            // Create a clear event to unmark the button.\r\n            const clear = () => setBusyButtons(\r\n                busyButtons.filter(b => b !== \"Favorite\")\r\n            ); \r\n            \r\n            if (is_favorited)\r\n                // Remove the post from the favorites list.\r\n                API.removeFavorite(id).then(() => (post.is_favorited = false, clear()));\r\n            else\r\n                // Add the post to the favorites list.\r\n                API.favorite(id).then(() => (post.is_favorited = true, clear()));\r\n        },\r\n        vote: score => {\r\n            // Mark the button as busy.\r\n            setBusyButtons([ ...busyButtons, \"Upvote\", \"Downvote\" ]);\r\n            \r\n            // Create a clear event to unmark the button.\r\n            const clear = () => setBusyButtons(\r\n                busyButtons.filter(b => !~[\"Upvote\", \"Downvote\"].indexOf(b))\r\n            );\r\n            \r\n            // Vote on the post.\r\n            API.vote(id, score).then(data => (_.extend(post.score, data), clear()));\r\n        },\r\n        download: () => {\r\n            // Make sure the user isn't impatient.\r\n            if (downloading) return;\r\n            downloading = true;\r\n            \r\n            // Mark the button as busy.\r\n            setBusyButtons([ ...busyButtons, \"Download\" ]);\r\n            \r\n            // Create a clear event to unmark the button.\r\n            const clear = () => (setBusyButtons(\r\n                busyButtons.filter(b => b !== \"Download\")\r\n            ), downloading = false);\r\n            \r\n            // Download the post.\r\n            download(file.url).then(clear);\r\n        },\r\n        openInNewTab: () => window.open(`#post/${id}`, \"_blank\")\r\n    };\r\n    \r\n    const conditionalDnp = tags.artist.indexOf(\"conditional_dnp\");\r\n    !!~conditionalDnp && tags.artist.splice(conditionalDnp, 1);\r\n\r\n    // Render me harder, daddy.\r\n    return previewImage && file.ext !== \"swf\" ? (\r\n        <div className=\"Post\">\r\n            <div className=\"PostHeader\">\r\n                Artist{tags.artist.length > 1 ? \"s\" : null}\r\n                <div className=\"Divider\"/>\r\n                { tags.artist.length\r\n                    ? tags.artist.map((artist, i) => (\r\n                        <TagItem key={i}>\r\n                            {artist}\r\n                        </TagItem>\r\n                    ))\r\n                    : (\r\n                        <span style={{ opacity: 0.65 }}>\r\n                            unknown\r\n                        </span>\r\n                    ) }\r\n            </div>\r\n            \r\n            { !previewLoaded && (\r\n                <div className=\"Preview Flex Loading\">\r\n                    <InlineLoading/>\r\n                </div>\r\n            ) }\r\n            \r\n            <ContextMenu.Wrapper menu={<PostContextMenu post={post}/>}>\r\n                <img src={previewImage} className=\"Preview\" alt=\"Preview\"\r\n                     onLoad={() => setPreviewLoaded(true)}\r\n                     onClick={() =>\r\n                         openImageModal(file.url, () =>\r\n                             Posts.instance.posts.map(post => ({\r\n                                 preview: post.sample?.url ?? post.preview?.url ?? post.file?.url,\r\n                                 full: post.file.url\r\n                             })), {\r\n                             buttons: index => <PostModalButtons post={Posts.instance.posts[index]}/>\r\n                         })}/>\r\n            </ContextMenu.Wrapper>\r\n            \r\n            { file.ext === \"webm\" && (\r\n                <div className=\"VideoOverlay\">\r\n                    <Feather.Play/>\r\n                </div>\r\n            ) }\r\n            \r\n            <div className=\"PostFooter\" data-url={previewImage}>\r\n                { tooltipText && <div className={joinClassNames(\r\n                    \"FooterTooltip\", [tooltipSide === \"right\", \"RightSide\"]\r\n                )}>{tooltipText}</div> }\r\n                \r\n                <div className=\"VotesContainer\">\r\n                    <div className=\"Flex\">\r\n                        <Button text={score.up} tooltipText=\"Upvote\"\r\n                                className={score.our_score === 1 ? \"Active\" : \"\"}\r\n                                onClick={events.vote.bind(null, 1)}>\r\n                            <Feather.ThumbsUp/>\r\n                        </Button>\r\n                        \r\n                        <Button text={-score.down} tooltipText=\"Downvote\"\r\n                                className={score.our_score === -1 ? \"Active\" : \"\"}\r\n                                onClick={events.vote.bind(null, -1)}>\r\n                            <Feather.ThumbsDown/>\r\n                        </Button>\r\n                    </div>\r\n                    \r\n                    <div className=\"VotesTally\">\r\n                        <div className=\"UpVotes\" style={{\r\n                            width: ((score.up / (score.up + -score.down)) * 100) + \"%\"\r\n                        }}/>\r\n                    </div>\r\n                </div>\r\n\r\n                <Button text={fav_count} tooltipText=\"Favorite\"\r\n                        className={is_favorited ? \"Favorited\" : \"\"}\r\n                        onClick={events.toggleFavorite}>\r\n                    <Feather.Heart/>\r\n                </Button>\r\n                \r\n                <div style={{ marginLeft: \"auto\" }} className=\"Flex\">\r\n                    <Button tooltipText=\"Download\" tooltipSide=\"right\"\r\n                            onClick={events.download}>\r\n                        <Feather.Download/>\r\n                    </Button>\r\n                    \r\n                    <LinkWrapper href={`#post/${id}`}>\r\n                        <Button tooltipText=\"View Post\" tooltipSide=\"right\">\r\n                            <Feather.ExternalLink/>\r\n                        </Button>\r\n                    </LinkWrapper>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    ) : null;\r\n}\r\n\r\nexport function PostContextMenu({ post }) {\r\n    const sets = App.userData?.sets ?? [];\r\n    \r\n    const [, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n    \r\n    const events = {\r\n        toggleSet: async index => {\r\n            const set = App.userData?.sets[index];\r\n            const postIndex = set.post_ids.indexOf(post.id);\r\n            \r\n            if (postIndex !== -1) {\r\n                await API.request(\r\n                    `post_sets/${set.id}/remove_posts`,\r\n                    { \"post_ids[]\": post.id },\r\n                    true,\r\n                    { method: \"POST\" }\r\n                );\r\n\r\n                set.post_ids.splice(postIndex, 1);\r\n            }\r\n            else {\r\n                await API.request(\r\n                    `post_sets/${set.id}/add_posts`,\r\n                    { \"post_ids[]\": post.id },\r\n                    true,\r\n                    { method: \"POST\" }\r\n                );\r\n                \r\n                set.post_ids.push(post.id);\r\n            }\r\n        }\r\n    }\r\n    \r\n    return (\r\n        <ContextMenu>\r\n            <ContextMenu.Item\r\n                icon={<Feather.Clipboard/>}\r\n                onClick={() => copyToClipboard(post.id)}\r\n                autoClose\r\n            >Copy Post ID</ContextMenu.Item>\r\n            \r\n            <ContextMenu.Item\r\n                icon={<Feather.Image/>}\r\n                onClick={() => (Settings.props.backgroundImage.url.value = post.file.url, Settings.save(), SettingsRenderer.forceUpdate())}\r\n                autoClose\r\n            >Set As Background</ContextMenu.Item>\r\n            \r\n            <ContextMenu.Divider/>\r\n            \r\n            <ContextMenu.SubMenuItem\r\n                label=\"Sets\"\r\n                icon={<Feather.Layers/>}\r\n            >\r\n                { !!sets.length && (\r\n                    <React.Fragment>\r\n                        { sets.map((set, index) => (\r\n                            <ContextMenu.Item\r\n                                className={joinClassNames(\"ContextMenuItem\", \"SetCmItem\",\r\n                                    [!!~set.post_ids.indexOf(post.id), \"Active\"])}\r\n                                key={set.id}\r\n                                icon={<Feather.Plus/>}\r\n                                onClick={async () => (await events.toggleSet(index), forceUpdate())}\r\n                            >{set.name}</ContextMenu.Item>\r\n                        )) }\r\n\r\n                        <ContextMenu.Divider/>     \r\n                    </React.Fragment>\r\n                ) }\r\n                \r\n                <ContextMenu.Item\r\n                    icon={<Feather.PlusSquare/>}\r\n                    autoClose\r\n                    onClick={() => Modals.push(<CreateSetModal postId={post.id}/>)}\r\n                >New Set</ContextMenu.Item>\r\n            </ContextMenu.SubMenuItem>\r\n        </ContextMenu>\r\n    );\r\n}\r\n\r\n/**\r\n * Please, do not look at this component.\r\n * I was lazy.\r\n * Leave me alone.\r\n * No stop.\r\n * Please don't scroll down.\r\n * @param post\r\n * @returns {JSX.Element}\r\n * @constructor\r\n */\r\nexport function PostModalButtons({ post }) {\r\n    const {\r\n        id,\r\n        is_favorited,\r\n        score,\r\n        fav_count,\r\n        file\r\n    } = post;\r\n    \r\n    const [, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n    \r\n    const events = {\r\n        favorite: () => {\r\n            if (is_favorited)\r\n                // Remove the post from the favorites list.\r\n                API.removeFavorite(id).then(() => (post.is_favorited = false, forceUpdate()));\r\n            else\r\n                // Add the post to the favorites list.\r\n                API.favorite(id).then(() => (post.is_favorited = true, forceUpdate()));\r\n        },\r\n        vote: score =>\r\n            API.vote(id, score).then(data => (_.extend(post.score, data), forceUpdate())),\r\n        download: () => download(file.url)\r\n    }\r\n    \r\n    return (\r\n        <React.Fragment>\r\n            <div className=\"Button Flex\" style={{\r\n                alignItems: \"center\", justifyContent: \"center\",\r\n                color: score.our_score === 1 ? \"var(--primary-color)\" : null\r\n            }} onClick={events.vote.bind(null, 1)}>\r\n                <Feather.ThumbsUp/>\r\n                <div style={{ marginLeft: 5 }}>{score.up}</div>\r\n                \r\n                <Tooltip style={{ color: \"var(--txt-color)\" }}>Upvote</Tooltip>\r\n            </div>\r\n\r\n            <div className=\"Button Flex\" style={{\r\n                alignItems: \"center\", justifyContent: \"center\",\r\n                color: score.our_score === -1 ? \"var(--primary-color)\" : null\r\n            }} onClick={events.vote.bind(null, -1)}>\r\n                <Feather.ThumbsDown/>\r\n                <div style={{ marginLeft: 5 }}>{-score.down}</div>\r\n\r\n                <Tooltip style={{ color: \"var(--txt-color)\" }}>Downvote</Tooltip>\r\n            </div>\r\n\r\n            <div className=\"Button Flex\" style={{\r\n                alignItems: \"center\", justifyContent: \"center\",\r\n                color: is_favorited ? \"var(--red)\" : null\r\n            }} onClick={events.favorite}>\r\n                <Feather.Heart/>\r\n                <div style={{ marginLeft: 5 }}>{fav_count}</div>\r\n\r\n                <Tooltip style={{ color: \"var(--txt-color)\" }}>Favorite</Tooltip>\r\n            </div>\r\n\r\n            <div className=\"Button Flex\" style={{\r\n                alignItems: \"center\", justifyContent: \"center\"\r\n            }} onClick={events.download}>\r\n                <Feather.Download/>\r\n                <Tooltip style={{ color: \"var(--txt-color)\" }}>Download</Tooltip>\r\n            </div>\r\n        </React.Fragment>\r\n    );\r\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App/>\n\t</React.StrictMode>,\n\tdocument.getElementById(\"root\")\n);\n\nserviceWorker.unregister();"],"sourceRoot":""}